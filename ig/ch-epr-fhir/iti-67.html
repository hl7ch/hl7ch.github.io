<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
    <title>Find Document References [ITI-67] - CH EPR FHIR (R4) v4.0.1</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link href="fhir.css" rel="stylesheet"/>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>

    <!-- Project extras -->
    <link href="assets/css/project.css" rel="stylesheet"/>
    <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
    <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
  	<link href="assets/css/prism.css" rel="stylesheet" />
  	<link href="assets/css/cqf.css" rel="stylesheet" />
    <!-- Placeholder for child template CSS declarations -->
    <link href="assets/css/hl7.css" rel="stylesheet"/>
    <link href="assets/css/fhir.css" rel="stylesheet"/>

    <style>
    
    .navbar-inverse {
        background-color: #144b8a;
    }   

    #segment-footer .container {
      background-color: #144b8a;
    }
    

    

    
    #ig-status {
      color: #4fa2da;
    } 
    

    </style>
 

    <script type="text/javascript" src="fhir-table-scripts.js"> </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->

    <!-- Favicons -->
    <link rel="fhir-logo" sizes="144x144" href="assets/ico/icon-fhir-144.png"/>
    <link rel="fhir-logo" sizes="114x114" href="assets/ico/icon-fhir-114.png"/>
    <link rel="fhir-logo" sizes="72x72" href="assets/ico/icon-fhir-72.png"/>
    <link rel="fhir-logo" href="assets/ico/icon-fhir-57.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body onload="document.body.style.opacity='1'">

	  <script src="assets/js/prism.js"></script>
    <script type="text/javascript" src="assets/js/mermaid.js"></script>
    <script type="text/javascript" src="assets/js/mermaid-init.js"></script>
    <style type="text/css">h2{--heading-prefix:"3.7"}
    h3,h4,h5,h6{--heading-prefix:"3.7"}</style>
    <div id="segment-header" class="segment">  <!-- segment-header -->
      <div class="container">  <!-- container -->
        <!-- Placeholder for child template header declarations -->

            <!--
<div id="family-nav">
	<a id="logo" no-external="true" href="http://hl7.org/fhir"> <img
		alt="logo fhir" src="assets/images/fhir-logo-www.png" />
	</a>
</div>
-->


            <div id="family-nav">
                <a id="logo" no-external="true" href="searchform.html">
                    <img src="assets/images/search.png" alt="Search FHIR" />
                </a>
            </div>
            <div id="hl7-nav">
    <a id="ehealthsuisse-logo" no-external="true" href="https://www.e-health-suisse.ch">
        <img alt="visit the e-health-suisse website" height="60" src="assets/images/LogoDE_ehealthsuisse.svg" />
    </a>            
</div>

        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">CH EPR FHIR (R4)</span>
            <br/>
            <span style="display:inline-block;">4.0.1 - trial-use



  <img alt="Switzerland flag" src="assets/images/che.svg" height="16" title="Switzerland"/>


            </span>
          </p>
        </div>
      </div> <!-- /container -->
    </div>  <!-- /segment-header -->

    <div id="segment-navbar" class="segment">  <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">  <!-- container -->
        <!-- HEADER CONTENT -->

        <nav class="navbar navbar-inverse">
          <!--status-bar-->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <ul xmlns="http://www.w3.org/1999/xhtml" class="nav navbar-nav">
    <li>
        <a href="index.html">Home</a>
    </li>
    <li class="Profiles">
        <a data-toggle="dropdown" href="#" class="dropdown-toggle">Volume 1
            <b class="caret">
            </b>
        </a>
        <ul class="dropdown-menu">
            <li>
                <a href="iti-iua.html">Internet User Authorization (IUA)</a>
            </li>
            <li>
                <a href="iti-pdqm.html">Patient Demographics Query for mobile (PDQm)</a>
            </li>
            <li>
                <a href="iti-pixm.html">Patient Identifier Cross-referencing for mobile (PIXm)</a>
            </li>
            <li>
                <a href="iti-mhd.html">Mobile Access to Health Documents (MHD)</a>
            </li>
            <li>
                <a href="iti-restful-atna.html">RESTful ATNA</a>
            </li>
            <li>
                <a href="iti-mcsd.html">Mobile Care Services Discovery (mCSD)</a>
            </li>
            <li>
                <a href="ppqm.html">Privacy Policy Query for Mobile (CH:PPQm)</a>
            </li>
        </ul>
    </li>
    <li class="dropdown">
        <a data-toggle="dropdown" href="#" class="dropdown-toggle">Volume 2
            <b class="caret">
            </b>
        </a>
        <ul class="dropdown-menu">
            <li>
                <a href="iti-103.html">Get Authorization Server Metadata [ITI-103]</a>
            </li>
            <li>
                <a href="iti-71.html">Get Access Token [ITI-71]</a>
            </li>
            <li>
                <a href="iti-104.html">Patient Identity Feed FHIR [ITI-104]</a>
            </li>
            <li>
                <a href="iti-119.html">Patient Demographics Match [ITI-119]</a>
            </li>
            <li>
                <a href="iti-83.html">Mobile Patient Identifier Cross-reference Query [ITI-83]</a>
            </li>
            <li>
                <a href="iti-65.html">Provide Document Bundle [ITI-65]</a>
            </li>
            <li>
                <a href="iti-67.html">Find Document References [ITI-67]</a>
            </li>
            <li>
                <a href="iti-68.html">Retrieve Document [ITI-68]</a>
            </li>
            <li>
                <a href="ch-mhd-1.html">Update Document Metadata [CH:MHD-1]</a>
            </li>
            <li>
                <a href="iti-20.html">Record Audit Event [ITI-20]</a>
            </li>
            <li>
                <a href="iti-90.html">Find Matching Care Services [ITI-90]</a>
            </li>
            <li>
                <a href="ch-mcsd-1.html">Care Services Feed [CH:mCSD-1]</a>
            </li>
            <li>
                <a href="ppq-3.html">Mobile Privacy Policy Feed [PPQ-3]</a>
            </li>
            <li>
                <a href="ppq-4.html">Mobile Privacy Policy Bundle Feed [PPQ-4]</a>
            </li>
            <li>
                <a href="ppq-5.html">Mobile Privacy Policy Retrieve [PPQ-5]</a>
            </li>
        </ul>
    </li>
    <li class="dropdown">
        <a data-toggle="dropdown" href="#" class="dropdown-toggle">Appendix
            <b class="caret">
            </b>
        </a>
        <ul class="dropdown-menu">
            <li>
                <a href="profiles.html">Profiles</a>
            </li>
            <li>
                <a href="extensions.html">Extensions</a>
            </li>
            <li>
                <a href="terminology.html">Terminology</a>
            </li>
            <li>
                <a href="capstatements.html">Capability Statements</a>
            </li>
            <li>
                <a href="operations.html">Operations</a>
            </li>
            <li>
                <a href="sequencediagrams.html">Sequence diagrams</a>
            </li>
            <li>
                <a href="tracecontext.html">Trace Context</a>
            </li>
            <li>
                <a href="changelog.html">Open Issues / Change Log</a>
            </li>
        </ul>
    </li>
    <li>
        <a href="artifacts.html">Artifacts</a>
    </li>
</ul>

            </div>  <!-- /.nav-collapse -->
          </div>  <!-- /.container -->
        </nav>  <!-- /.navbar -->
      <!-- /HEADER CONTENT -->
      </div>  <!-- /container -->
    </div>  <!-- /segment-navbar -->
    <!--status-bar-->

    <div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
      <div class="container">  <!-- container -->
        <ul class="breadcrumb">
          <li><a href='toc.html'><b>Table of Contents</b></a></li><li><a href='volume2.html'><b>Volume 2</b></a></li><li><b>Find Document References [ITI-67]</b></li>

        </ul>
      </div>  <!-- /container -->
    </div>  <!-- /segment-breadcrumb -->

    <a name="top"> </a>
    <div id="segment-content" class="segment">  <!-- segment-content -->
      <div class="container">  <!-- container -->
        <div class="row">
          <div class="inner-wrapper">

<style type="text/css">
h2:before{color:silver;counter-increment:section;content:var(--heading-prefix) " ";}
h3:before{color:silver;counter-increment:sub-section;content:var(--heading-prefix) "." counter(sub-section) " ";}
h4:before{color:silver;counter-increment:composite;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) " ";}
h5:before{color:silver;counter-increment:detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) " ";}
h6:before{color:silver;counter-increment:more-detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) "." counter(more-detail)" ";}
</style>
<div class="col-12">
  <!--ReleaseHeader--><p id="publish-box">This page is part of the CH EPR FHIR (R4) (v4.0.1: <a no-external="true" href="https://confluence.hl7.org/display/HL7/HL7+Balloting" title="Draft Standard for Trial-Use">DSTU</a> 4) based on <a no-external="true" href="http://hl7.org/fhir/R4">FHIR (HL7® FHIR® Standard) R4</a>. This is the current published version.  For a full list of available versions, see the <a no-external="true" href="http://fhir.ch/ig/ch-epr-fhir/history.html">Directory of published versions</a></p><!--EndReleaseHeader-->
  <h2>Find Document References [ITI-67]</h2>
  












    <p><!-- white space is critical inside of capture --></p>
<div class="markdown-toc">
<ul id="markdown-toc">
  <li><a href="#scope" id="markdown-toc-scope">Scope</a></li>
  <li><a href="#actor-roles" id="markdown-toc-actor-roles">Actor Roles</a></li>
  <li><a href="#referenced-standards" id="markdown-toc-referenced-standards">Referenced Standards</a></li>
  <li><a href="#messages" id="markdown-toc-messages">Messages</a></li>
  <li><a href="#security-consideration" id="markdown-toc-security-consideration">Security Consideration</a></li>
</ul>

</div>
<p>This section describes the additional requirements for the Swiss EPR of the <a href="https://profiles.ihe.net/ITI/MHD/ITI-67.html">Find Document References
[ITI-67]</a> transaction defined in the MHD Profile published in the IHE ITI
Trial Implementation “Mobile Access to Health Documents”.</p>

<h3 id="scope">Scope</h3>

<p>The Find Document References transaction is used to find DocumentReference Resources that
satisfy a set of parameters. It is equivalent to the <em>FindDocuments</em> and
<em>FindDocumentsByReferenceId</em> queries from the <em>Registry Stored Query</em> [ITI-18] transaction. The
result of the query is a FHIR Bundle containing DocumentReference Resources that match the
query parameters.</p>

<h3 id="actor-roles">Actor Roles</h3>

<p><strong>Actor:</strong> Document Consumer <br />
<strong>Role:</strong> Requests a list of DocumentReference Resources, matching the supplied set of criteria, from the Document Responder. <br />
<strong>Actor:</strong> Document Responder <br />
<strong>Role:</strong> Returns DocumentReference Resources that match the search criteria provided by the Document Consumer.</p>

<h3 id="referenced-standards">Referenced Standards</h3>

<ol>
  <li><a href="https://profiles.ihe.net/ITI/MHD/4.2.2">Mobile access to Health Documents (MHD), Rev. 4.2.2</a></li>
  <li>This MHD Profile is based on Release 4 of the <a href="https://hl7.org/fhir/R4/index.html">HL7® FHIR®</a> standard.</li>
</ol>

<h3 id="messages">Messages</h3>

<div><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="158px" preserveAspectRatio="none" style="width:443px;height:158px;background:#FFFFFF;" version="1.1" viewBox="0 0 443 158" width="443px" zoomAndPan="magnify"><defs /><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="243" x="99.25" y="27.9951">Interaction Diagram for [ITI-67]</text><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="348.5" y="104.7266" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="86" x2="86" y1="73.5938" y2="151.8594" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="353.5" x2="353.5" y1="73.5938" y2="151.8594" /><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="5" y="42.2969" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="12" y="62.292">Document Consumer</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="269.5" y="42.2969" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="276.5" y="62.292">Document Responder</text><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="348.5" y="104.7266" /><polygon fill="#181818" points="336.5,100.7266,346.5,104.7266,336.5,108.7266,340.5,104.7266" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="342.5" y1="104.7266" y2="104.7266" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="93.5" y="99.6606">Find Document References Request</text><polygon fill="#181818" points="97.5,129.8594,87.5,133.8594,97.5,137.8594,93.5,133.8594" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="91.5" x2="352.5" y1="133.8594" y2="133.8594" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238" x="103.5" y="128.7935">Find Document References Response</text></g></svg></div>

<h4 id="find-document-references-request-message">Find Document References Request Message</h4>

<p>The Document Consumer SHALL include the search parameter patient.identifier with the oid of the EPR-SPID.
The search parameters of type <a href="https://hl7.org/fhir/R4/search.html#token">token</a> SHALL contain both the system and the code.</p>

<p><em>Find Document Reference</em> example <strong>request</strong>:</p>
<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">[base]/DocumentReference?patient.identifier=urn:oid:2.16.756.5.30.1.127.3.10.3|761337610411353650&amp;status=current</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/fhir+json</span>
<span class="na">traceparent</span><span class="p">:</span> <span class="s">00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-00</span>
</code></pre></div></div>

<h4 id="expected-actions">Expected Actions</h4>

<p>The Document Responder SHALL process the query to discover the DocumentReference entries that match the search parameters given.</p>

<p>Document Responder SHALL support search page count requests from the Document Consumer of up to 100 resources.</p>

<h5 id="federated-cross-community-access-option">Federated Cross Community Access Option</h5>

<p>If the Document Responder supports the Federated Cross Community Access Option the Document Responder SHALL delegate the queries
to the different connected communities and aggregate and sort the results including the results of his own community.</p>

<p>The Document Responder SHALL freeze the result set from the federated cross community queries and allow paged access by the Document Consumer. 
Subsequent query to an individual result by the Document Consumer SHALL return the current resource, not the frozen one.</p>

<div class="mermaid">
%%{
    init: {
        'theme': 'neutral',
        'themeVariables': {
           'fontSize': '14px'
        }
    }
}%%
flowchart LR
    A[Document Consumer] --&gt;|Query| B(Document Responder
    Option FXCA
    Grouped with Document Consumer)
    B --&gt; C(Document Responder own community)
    B --&gt; D(Document Responders federated communities)
</div>

<h4 id="find-document-references-response-message">Find Document References Response Message</h4>

<p>The response Bundle SHALL follow the <a href="StructureDefinition-ch-mhd-documentreference-comprehensive-bundle.html">CH MHD Find Document References Comprehensive Response message</a>
Profile (<a href="Bundle-Bundle-FindDocumentReferences.html">example: MHD Find DocumentReferences</a>).</p>

<h5 id="federated-cross-community-access-option-1">Federated Cross Community Access Option</h5>

<p>If a Document Responder does not respond, an OperationOutcome with a severity warning SHALL be added to the aggregated results indicating the community does not respond.</p>

<p>For matching DocumentReferences returned by the Document Responder, the Document Responder SHALL ensure by rewriting the id and attachment.url that follow-up reads, updates or document retrieval will be handled by same Document Responder actor. Any id, url rewrite SHALL be resolvable for at least an hour.</p>

<h4 id="capabilitystatement-resource">CapabilityStatement Resource</h4>

<p>The CapabilityStatement resource for the <strong>Document Consumer</strong> is <a href="CapabilityStatement-CH.MHD.DocumentConsumer.html">MHD Document Consumer</a>.</p>

<p>The CapabilityStatement resource for the <strong>Document Responder</strong> is <a href="CapabilityStatement-CH.MHD.DocumentResponder.html">MHD Document Responder</a>.</p>

<h3 id="security-consideration">Security Consideration</h3>

<p>The transaction SHALL be secured by Transport Layer Security (TLS) encryption and server authentication with
server certificates. Transactions across communities SHALL use mTLS.</p>

<p>The transaction SHALL use client authentication and authorization using extended authorization token as defined
in the <a href="https://profiles.ihe.net/ITI/IUA">IUA profile</a>. The extended authorization token SHALL be conveyed as
defined in the <a href="https://profiles.ihe.net/ITI/IUA/index.html#372-incorporate-access-token-iti-72">Incorporate Access Token [ITI-72]</a>
transaction.</p>

<p>All Document Responders except the one with the Federated Cross Community Access Option SHALL be grouped with the Authorization Decision Consumer actor of the CH:ADR profile
defined in Extension 2.1 to Annex 5 of the ordinances and perform an Authorization Decision Request [CH:ADR] for
every Find Document References [ITI-67] response.</p>

<p>The actors SHALL support the <em>traceparent</em> header handling, as defined in <a href="tracecontext.html">Appendix: Trace Context</a>.</p>

<h4 id="security-audit-considerations">Security Audit Considerations</h4>

<h5 id="document-consumer-audit">Document Consumer Audit</h5>

<p>The <strong>Document Consumer</strong> shall record a
<a href="StructureDefinition-ChAuditEventIti67Consumer.html">CH Audit Event for [ITI-67] Document Consumer</a> 
(<a href="AuditEvent-ChAuditEventIti67ConsumerExample.html">example</a>).</p>

<h5 id="document-responder-audit">Document Responder Audit</h5>

<p>The <strong>Document Responder</strong> shall record a
<a href="StructureDefinition-ChAuditEventIti67Responder.html">CH Audit Event for [ITI-67] Document Responder</a>
(<a href="AuditEvent-ChAuditEventIti67ResponderExample.html">example</a>).</p>




</div>
        </div>  <!-- /inner-wrapper -->
      </div>  <!-- /row -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-content -->

  <script type="text/javascript" src="assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script type="text/javascript" src="assets/js/jquery-ui.min.js"> </script>

  <script type="text/javascript" src="assets/js/window-hash.js"> </script>
  <a name="bottom"> </a>
  <div id="segment-footer" igtool="footer" class="segment">  <!-- segment-footer -->
    <div class="container">  <!-- container -->

      <div class="inner-wrapper">
        <p>
          IG &#169; 2020+ <a style="color:var(--footer-hyperlink-text-color)" href="https://www.e-health-suisse.ch">eHealth Suisse</a>.  Package ch.fhir.ig.ch-epr-fhir#4.0.1 based on <a style="color: var(--footer-hyperlink-text-color)" href="http://hl7.org/fhir/R4/">FHIR 4.0.1</a>. Generated <span title="Wed, Dec 18, 2024 12:16+0000">2024-12-18</span>
          <br/>
          <span style="color: var(--footer-highlight-text-color)">
                      Links: <a style="color: var(--footer-hyperlink-text-color)" href="toc.html">Table of Contents</a> |
                 <a style="color: var(--footer-hyperlink-text-color)" href="qa.html">QA Report</a>
                 
                

| <a style="color: #81BEF7" target="_blank" href="https://docs.google.com/forms/d/e/1FAIpQLSffM9HysTOg3VdMOeaFmWiWGH0OQT-FZLmwZaeXgZqUr66Y0A/viewform?usp=sf_link&amp;entry%2E1353807103=ch.fhir.ig.ch-epr-fhir%234.0.1%20/iti-67.html&amp;entry%2E247644557=Find%20Document%20References%20[ITI-67]">Propose a change</a>




          </span>
        </p>
      </div>  <!-- /inner-wrapper -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
    <div class="container">  <!-- container -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-post-footer -->

  <!-- JS and analytics only. -->
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="assets/js/bootstrap.min.js"> </script>
  <script type="text/javascript" src="assets/js/respond.min.js"> </script>
  <script type="text/javascript" src="assets/js/anchor.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard-btn.js"> </script>
  <script type="text/javascript" src="assets/js/anchor-hover.js"> </script>
  <!-- Analytics Below
  ================================================== -->
  </body>
</html>

