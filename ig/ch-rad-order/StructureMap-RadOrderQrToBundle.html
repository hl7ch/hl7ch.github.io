<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
    <title>RadOrderQrToBundle - CH RAD-Order (R4) v2.0.0</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link href="fhir.css" rel="stylesheet"/>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>

    <!-- Project extras -->
    <link href="assets/css/project.css" rel="stylesheet"/>
    <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
    <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
  	<link href="assets/css/prism.css" rel="stylesheet" />
  	<link href="assets/css/cqf.css" rel="stylesheet" />
    <!-- Placeholder for child template CSS declarations -->
    <link href="assets/css/hl7.css" rel="stylesheet"/>
    <link href="assets/css/fhir.css" rel="stylesheet"/>

    <style>
    

    

    

    </style>
 

    <script type="text/javascript" src="fhir-table-scripts.js"> </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->

    <!-- Favicons -->
    <link rel="fhir-logo" sizes="144x144" href="assets/ico/icon-fhir-144.png"/>
    <link rel="fhir-logo" sizes="114x114" href="assets/ico/icon-fhir-114.png"/>
    <link rel="fhir-logo" sizes="72x72" href="assets/ico/icon-fhir-72.png"/>
    <link rel="fhir-logo" href="assets/ico/icon-fhir-57.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body onload="document.body.style.opacity='1'">

	  <script src="assets/js/prism.js"></script>
    <script type="text/javascript" src="assets/js/mermaid.js"></script>
    <script type="text/javascript" src="assets/js/mermaid-init.js"></script>
    <style type="text/css">h2{--heading-prefix:"10.33"}
    h3,h4,h5,h6{--heading-prefix:"10.33"}</style>
    <div id="segment-header" class="segment">  <!-- segment-header -->
      <div class="container">  <!-- container -->
        <!-- Placeholder for child template header declarations -->

            <div id="family-nav">
	<a id="logo" no-external="true" href="http://hl7.org/fhir"> <img
		alt="logo fhir" src="fhir-logo-www.png" />
	</a>
</div>

            <div id="family-nav">
                <a id="logo" no-external="true" href="searchform.html">
                    <img src="assets/images/search.png" alt="Search FHIR" />
                </a>
            </div>
            <div id="hl7-nav">
    <a id="hl7-logo" no-external="true" href="http://www.hl7.ch">
        <img alt="visit the hl7 website" height="50" src="hl7-logo.png" />
    </a>            
</div>

        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">CH RAD-Order (R4)</span>
            <br/>
            <span style="display:inline-block;">2.0.0 - trial-use



  <img alt="Switzerland flag" src="assets/images/che.svg" height="16" title="Switzerland"/>


            </span>
          </p>
        </div>
      </div> <!-- /container -->
    </div>  <!-- /segment-header -->

    <div id="segment-navbar" class="segment">  <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">  <!-- container -->
        <!-- HEADER CONTENT -->

        <nav class="navbar navbar-inverse">
          <!--status-bar-->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <ul xmlns="http://www.w3.org/1999/xhtml" class="nav navbar-nav">
  <!--<li>
    <a href="toc.html">Table of Contents</a>
  </li>-->
  <li>
    <a href="index.html">Home</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Use Cases<b class="caret">
      </b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="usecase-english.html">English</a>
      </li>
      <li>
        <a href="usecase-german.html">German</a>
      </li>
      <!--<li>
        <a href="usecase-french.html">French</a>
      </li>-->
    </ul>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Questionnaire<b class="caret">
      </b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="Questionnaire-QuestionnaireRadiologyOrder.html">Specification</a>
      </li>
      <li>
        <a href="questionnaire-form.html">Form</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="profiles.html">Profiles</a>
  </li>
  <li>
    <a href="extensions.html">Extensions</a>
  </li>
  <li>
    <a href="terminology.html">Terminology</a>
  </li>
  <li>
    <a href="artifacts.html">Artifacts</a>
  </li>
</ul>
            </div>  <!-- /.nav-collapse -->
          </div>  <!-- /.container -->
        </nav>  <!-- /.navbar -->
      <!-- /HEADER CONTENT -->
      </div>  <!-- /container -->
    </div>  <!-- /segment-navbar -->
    <!--status-bar-->

    <div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
      <div class="container">  <!-- container -->
        <ul class="breadcrumb">
          <li><a href='toc.html'><b>Table of Contents</b></a></li><li><a href='artifacts.html'><b>Artifacts Summary</b></a></li><li><b>RadOrderQrToBundle</b></li>

        </ul>
      </div>  <!-- /container -->
    </div>  <!-- /segment-breadcrumb -->

    <a name="top"> </a>
    <div id="segment-content" class="segment">  <!-- segment-content -->
      <div class="container">  <!-- container -->
        <div class="row">
          <div class="inner-wrapper">

<div class="col-12">
  <!--ReleaseHeader--><p id="publish-box">This page is part of the CH RAD-Order (R4) (v2.0.0: <a no-external="true" href="https://confluence.hl7.org/display/HL7/HL7+Balloting" title="Standard for Trial-Use">STU</a> 2) based on <a no-external="true" href="http://hl7.org/fhir/R4">FHIR (HL7® FHIR® Standard) R4</a>. This is the current published version.  For a full list of available versions, see the <a no-external="true" href="http://fhir.ch/ig/ch-rad-order/history.html">Directory of published versions</a></p><!--EndReleaseHeader-->
  








<ul class="nav nav-tabs">

  <li class="active">
    <a href="#">Narrative Content</a>
  </li>



  
    <li>
      <a href="StructureMap-RadOrderQrToBundle.xml.html">XML</a>
    </li>
  


  
    <li>
      <a href="StructureMap-RadOrderQrToBundle.json.html">JSON</a>
    </li>
  




</ul>

  <a name="root"> </a>

  <h2 id="root">StructureMap: RadOrderQrToBundle

  </h2>

  <table class="colsd">

    <tr>
      <td colspan="4"><i>Official URL</i>: <span class="copy-text">http://fhir.ch/ig/ch-rad-order/StructureMap/RadOrderQrToBundle<button title="Click to copy URL" class="btn-copy" data-clipboard-text="http://fhir.ch/ig/ch-rad-order/StructureMap/RadOrderQrToBundle"/></span>
      </td>
      <td><i>Version</i>:
      <span class="copy-text">2.0.0<button title="Click to copy versioned URL" class="btn-copy" data-clipboard-text="http://fhir.ch/ig/ch-rad-order/StructureMap/RadOrderQrToBundle|2.0.0"/></span>
      </td>
    </tr>

    <tr>







      <td colspan="4">
        
          Draft
          
            as of 2024-12-18
          
        
      </td>



      <td><i>Computable Name</i>: <span style="font-family: monospace;">RadOrderQrToBundle</span></td>
    </tr>




    <tr>
      <td colspan="5"><p><em>Copyright/Legal</em>: CC0-1.0</p>
</td>
    </tr>

  </table>


<p>
<p>Radiologoy QuestionnaireResponse to Bundle
Derived from ORF QuestionnaireResponse to Bundle
2021-01-11 Oliver Egger, copyright ahdis ag, Apache License
QRF Questionnaire: http://fhir.ch/ig/ch-orf/Questionnaire-order-referral-form.html
QRF QuestionnaireResponse: http://fhir.ch/ig/ch-orf/QuestionnaireResponse-order-referral-form.xml.html
Bundle: http://fhir.ch/ig/ch-orf/StructureDefinition-ch-orf-document.html</p>

</p>


  <!-- insert intro if present -->
  



<!--  <p>
  Formats: <a href="StructureMap-RadOrderQrToBundle.xml.html">XML</a>, <a href="StructureMap-RadOrderQrToBundle.json.html">JSON</a>, <a href="StructureMap-RadOrderQrToBundle.ttl.html">Turtle</a>
  </p>-->

  


  <div xmlns="http://www.w3.org/1999/xhtml"><p class="res-header-id"><b>Generated Narrative: StructureMap RadOrderQrToBundle</b></p><a name="RadOrderQrToBundle"> </a><a name="hcRadOrderQrToBundle"> </a><a name="RadOrderQrToBundle-en-US"> </a><pre class="fml">
<b>map</b><span style="color: navy"> &quot;</span>http://fhir.ch/ig/ch-rad-order/StructureMap/RadOrderQrToBundle<span style="color: navy">&quot; = &quot;</span>RadOrderQrToBundle<span style="color: navy">&quot;

</span><span style="color: navy">// </span><span style="color: green">Radiologoy QuestionnaireResponse to Bundle</span>
<span style="color: navy">// </span><span style="color: green">Derived from ORF QuestionnaireResponse to Bundle</span>
<span style="color: navy">// </span><span style="color: green">2021-01-11 Oliver Egger, copyright ahdis ag, Apache License</span>
<span style="color: navy">// </span><span style="color: green">QRF Questionnaire: http://fhir.ch/ig/ch-orf/Questionnaire-order-referral-form.html</span>
<span style="color: navy">// </span><span style="color: green">QRF QuestionnaireResponse: http://fhir.ch/ig/ch-orf/QuestionnaireResponse-order-referral-form.xml.html</span>
<span style="color: navy">// </span><span style="color: green">Bundle: http://fhir.ch/ig/ch-orf/StructureDefinition-ch-orf-document.html</span>

<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/questionnaireresponse.html" title="QuestionnaireResponse">http://hl7.org/fhir/StructureDefinition/QuestionnaireResponse</a><span style="color: navy">&quot; </span><b>alias </b>QuestionnaireResponse <b>as </b><b>source</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/bundle.html" title="Bundle">http://hl7.org/fhir/StructureDefinition/Bundle</a><span style="color: navy">&quot; </span><b>alias </b>Bundle <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/composition.html" title="Composition">http://hl7.org/fhir/StructureDefinition/Composition</a><span style="color: navy">&quot; </span><b>alias </b>Composition <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/patient.html" title="Patient">http://hl7.org/fhir/StructureDefinition/Patient</a><span style="color: navy">&quot; </span><b>alias </b>Patient <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/relatedperson.html" title="RelatedPerson">http://hl7.org/fhir/StructureDefinition/RelatedPerson</a><span style="color: navy">&quot; </span><b>alias </b>RelatedPerson <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/organization.html" title="Organization">http://hl7.org/fhir/StructureDefinition/Organization</a><span style="color: navy">&quot; </span><b>alias </b>Organization <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/practitioner.html" title="Practitioner">http://hl7.org/fhir/StructureDefinition/Practitioner</a><span style="color: navy">&quot; </span><b>alias </b>Practitioner <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/practitionerrole.html" title="PractitionerRole">http://hl7.org/fhir/StructureDefinition/PractitionerRole</a><span style="color: navy">&quot; </span><b>alias </b>PractitionerRole <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/servicerequest.html" title="ServiceRequest">http://hl7.org/fhir/StructureDefinition/ServiceRequest</a><span style="color: navy">&quot; </span><b>alias </b>ServiceRequest <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/extensibility.html#Extension" title="Extension">http://hl7.org/fhir/StructureDefinition/Extension</a><span style="color: navy">&quot; </span><b>alias </b>Extension <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/episodeofcare.html" title="EpisodeOfCare">http://hl7.org/fhir/StructureDefinition/EpisodeOfCare</a><span style="color: navy">&quot; </span><b>alias </b>EpisodeOfCare <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/questionnaireresponse.html" title="QuestionnaireResponse">http://hl7.org/fhir/StructureDefinition/QuestionnaireResponse</a><span style="color: navy">&quot; </span><b>alias </b>QuestionnaireResponseTarget <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/questionnaireresponse.html" title="QuestionnaireResponse">http://hl7.org/fhir/StructureDefinition/QuestionnaireResponse</a><span style="color: navy">&quot; </span><b>alias </b>QuestionnaireResponse <b>as </b><b>source</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/bundle.html" title="Bundle">http://hl7.org/fhir/StructureDefinition/Bundle</a><span style="color: navy">&quot; </span><b>alias </b>Bundle <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/patient.html" title="Patient">http://hl7.org/fhir/StructureDefinition/Patient</a><span style="color: navy">&quot; </span><b>alias </b>Patient <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/organization.html" title="Organization">http://hl7.org/fhir/StructureDefinition/Organization</a><span style="color: navy">&quot; </span><b>alias </b>Organization <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/practitioner.html" title="Practitioner">http://hl7.org/fhir/StructureDefinition/Practitioner</a><span style="color: navy">&quot; </span><b>alias </b>Practitioner <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/practitionerrole.html" title="PractitionerRole">http://hl7.org/fhir/StructureDefinition/PractitionerRole</a><span style="color: navy">&quot; </span><b>alias </b>PractitionerRole <b>as </b><b>target</b>
<b>uses</b><span style="color: navy"> &quot;</span><a href="http://hl7.org/fhir/R4/servicerequest.html" title="ServiceRequest">http://hl7.org/fhir/StructureDefinition/ServiceRequest</a><span style="color: navy">&quot; </span><b>alias </b>ServiceRequest <b>as </b><b>target</b>

<b>imports</b><span style="color: navy"> &quot;</span><a href="http://fhir.ch/ig/ch-orf/3.0.0/StructureMap-OrfQrToBundle.html" title="OrfQrToBundle">http://fhir.ch/ig/ch-orf/StructureMap/OrfQrToBundle</a><span style="color: navy">&quot;
</span>
<b>group </b>RadOrderQrToBundle<span style="color: navy">(</span><b>source</b> <span style="color: maroon">qr</span><span style="color: navy"> : </span>QuestionnaireResponse, <b>target</b> <span style="color: maroon">bundle</span><span style="color: navy"> : </span>Bundle<span style="color: navy">)</span><span style="color: navy"> {
</span>  qr<span style="color: navy"><b> -&gt; </b></span> bundle.identifier<b> as </b><span style="color: maroon">documentIdentifier</span><span style="color: navy">, </span> documentIdentifier.system = <span style="color: blue">'urn:ietf:rfc:3986'</span><span style="color: navy">, </span> <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuidDoc</span><span style="color: navy">, </span> documentIdentifier.value = <b>append</b><span style="color: navy">(</span><span style="color: blue">'urn:uuid:'</span><span style="color: navy">, </span><span style="color: maroon">uuidDoc</span><span style="color: navy">)</span> <i>&quot;documentIdentifier&quot;</i><span style="color: navy">;</span>
  qr<b> as </b><span style="color: maroon">qrcp</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Composition'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">composition</span><span style="color: navy">, </span> composition.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> composition.title = <span style="color: blue">'Radiologieauftrag'</span><span style="color: navy">, </span> composition.type<b> as </b><span style="color: maroon">type</span><span style="color: navy">, </span> type.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'2161000195103'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'urn:oid:2.16.756.5.30.1.127.3.4'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Imaging order (record artifact)'</span><span style="color: navy">, </span> composition.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'721963009'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Order (record artifact)'</span><span style="color: navy">, </span> bundle.entry<b> as </b><span style="color: maroon">e2</span><span style="color: navy">, </span> bundle.timestamp = <span style="color: navy">(</span>now()<span style="color: navy">)</span><b> as </b><span style="color: maroon">timestamp</span><span style="color: navy">, </span> bundle.type = <span style="color: blue">'document'</span><span style="color: navy">, </span> composition.date = <span style="color: maroon">timestamp</span><span style="color: navy">, </span> e2.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Patient'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">patient</span><span style="color: navy">, </span> patient.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid2</span><span style="color: navy">, </span> e2.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid2<span style="color: navy">)</span><span style="color: navy">, </span> bundle.entry<b> as </b><span style="color: maroon">e4</span><span style="color: navy">, </span> e4.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'QuestionnaireResponse'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">questionnaireresp</span><b> then</b><span style="color: navy"> {
</span>    qr<b> then </b>QuestionnaireResponseMap<span style="color: navy">(</span><span style="color: maroon">qr</span><span style="color: navy">, </span><span style="color: maroon">questionnaireresp</span><span style="color: navy">)</span> <i>&quot;questionnaireresp&quot;</i><span style="color: navy">;</span>
    qr<span style="color: navy"><b> -&gt; </b></span> questionnaireresp.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid4</span><span style="color: navy">, </span> e4.fullUrl = <b>append</b><span style="color: navy">(</span><span style="color: blue">'urn:uuid:'</span><span style="color: navy">, </span><span style="color: maroon">uuid4</span><span style="color: navy">)</span><span style="color: navy">, </span> bundle.entry<b> as </b><span style="color: maroon">e5</span><span style="color: navy">, </span> e5.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'ServiceRequest'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">servicerequest</span><span style="color: navy">, </span> servicerequest.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid5</span><span style="color: navy">, </span> e5.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid5<span style="color: navy">)</span><b> then</b><span style="color: navy"> {
</span>      qr<b> then </b>OrfComposition<span style="color: navy">(</span><span style="color: maroon">qr</span><span style="color: navy">, </span><span style="color: maroon">composition</span><span style="color: navy">, </span><span style="color: maroon">patient</span><span style="color: navy">, </span><span style="color: maroon">questionnaireresp</span><span style="color: navy">, </span><span style="color: maroon">servicerequest</span><span style="color: navy">, </span><span style="color: maroon">bundle</span><span style="color: navy">)</span> <i>&quot;composition&quot;</i><span style="color: navy">;</span>
      qr<b> then </b>QrToGroups<span style="color: navy">(</span><span style="color: maroon">questionnaireresp</span><span style="color: navy">, </span><span style="color: maroon">patient</span><span style="color: navy">, </span><span style="color: maroon">bundle</span><span style="color: navy">, </span><span style="color: maroon">composition</span><span style="color: navy">, </span><span style="color: maroon">servicerequest</span><span style="color: navy">)</span> <i>&quot;orf&quot;</i><span style="color: navy">;</span>
      qr<b> then </b>RadOrderQrToServiceRequest<span style="color: navy">(</span><span style="color: maroon">questionnaireresp</span><span style="color: navy">, </span><span style="color: maroon">patient</span><span style="color: navy">, </span><span style="color: maroon">bundle</span><span style="color: navy">, </span><span style="color: maroon">composition</span><span style="color: navy">, </span><span style="color: maroon">servicerequest</span><span style="color: navy">)</span> <i>&quot;servicerequest&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;servicerequest&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;orfbundle&quot;</i><span style="color: navy">;</span>
<span style="color: navy">}

</span><b>group </b>RadOrderQrToServiceRequest<span style="color: navy">(</span><b>source</b> <span style="color: maroon">qr</span><span style="color: navy"> : </span>QuestionnaireResponse, <b>target</b> <span style="color: maroon">patient</span><span style="color: navy"> : </span>Patient, <b>target</b> <span style="color: maroon">bundle</span><span style="color: navy"> : </span>Bundle, <b>target</b> <span style="color: maroon">composition</span><span style="color: navy"> : </span>Composition, <b>target</b> <span style="color: maroon">serviceRequest</span><span style="color: navy"> : </span>ServiceRequest<span style="color: navy">)</span><span style="color: navy"> {
</span>  qr.item<b> as </b><span style="color: maroon">grp</span><b> where </b>linkId = 'requestedService'<b> then </b>RequestedServiceItems<span style="color: navy">(</span><span style="color: maroon">grp</span><span style="color: navy">, </span><span style="color: maroon">serviceRequest</span><span style="color: navy">)</span> <i>&quot;requestedService&quot;</i><span style="color: navy">;</span>
  qr.item<b> as </b><span style="color: maroon">grp</span><b> where </b>linkId = 'reason'<b> then </b>ReasonServiceItems<span style="color: navy">(</span><span style="color: maroon">grp</span><span style="color: navy">, </span><span style="color: maroon">serviceRequest</span><span style="color: navy">)</span> <i>&quot;reason&quot;</i><span style="color: navy">;</span>
  qr.item<b> as </b><span style="color: maroon">grp</span><b> where </b>linkId = 'imagingService'<b> then </b>ImagingServiceItems<span style="color: navy">(</span><span style="color: maroon">grp</span><span style="color: navy">, </span><span style="color: maroon">serviceRequest</span><span style="color: navy">)</span> <i>&quot;imagingService&quot;</i><span style="color: navy">;</span>
  qr.item<b> as </b><span style="color: maroon">grp</span><b> where </b>linkId = 'orderDetail'<b> then </b>OrderDetailServiceItems<span style="color: navy">(</span><span style="color: maroon">grp</span><span style="color: navy">, </span><span style="color: maroon">serviceRequest</span><span style="color: navy">)</span> <i>&quot;orderDetail&quot;</i><span style="color: navy">;</span>
  qr.item<b> as </b><span style="color: maroon">grp</span><b> where </b>linkId = 'desiredRadiologist'<b> then </b>DesiredRadiologistServiceItems<span style="color: navy">(</span><span style="color: maroon">grp</span><span style="color: navy">, </span><span style="color: maroon">bundle</span><span style="color: navy">, </span><span style="color: maroon">serviceRequest</span><span style="color: navy">)</span> <i>&quot;desiredRadiologist&quot;</i><span style="color: navy">;</span>
  qr.item<b> as </b><span style="color: maroon">grp</span><b> where </b>linkId = 'diagnosisList'<b> then </b>DiagnosisListServiceItems<span style="color: navy">(</span><span style="color: maroon">grp</span><span style="color: navy">, </span><span style="color: maroon">patient</span><span style="color: navy">, </span><span style="color: maroon">bundle</span><span style="color: navy">, </span><span style="color: maroon">serviceRequest</span><span style="color: navy">)</span> <i>&quot;diagnosisList&quot;</i><span style="color: navy">;</span>
  qr.item<b> as </b><span style="color: maroon">grp</span><b> where </b>linkId = 'caveat'<b> then </b>CaveatServiceItems<span style="color: navy">(</span><span style="color: maroon">grp</span><span style="color: navy">, </span><span style="color: maroon">patient</span><span style="color: navy">, </span><span style="color: maroon">bundle</span><span style="color: navy">, </span><span style="color: maroon">serviceRequest</span><span style="color: navy">)</span> <i>&quot;Caveat&quot;</i><span style="color: navy">;</span>
  qr.item<b> as </b><span style="color: maroon">grp</span><b> where </b>linkId = 'previousResults'<b> then</b><span style="color: navy"> {
</span>    grp.item<b> as </b><span style="color: maroon">grp</span><b> where </b>linkId = 'attachedFile'<b> then </b>PreviousImagingStudyResultsNonDicom<span style="color: navy">(</span><span style="color: maroon">grp</span><span style="color: navy">, </span><span style="color: maroon">bundle</span><span style="color: navy">, </span><span style="color: maroon">serviceRequest</span><span style="color: navy">, </span><span style="color: maroon">patient</span><span style="color: navy">)</span> <i>&quot;attachment&quot;</i><span style="color: navy">;</span>
    grp.item<b> as </b><span style="color: maroon">grp</span><b> where </b>linkId = 'dicomObject'<b> then </b>PreviousImagingStudyResults<span style="color: navy">(</span><span style="color: maroon">grp</span><span style="color: navy">, </span><span style="color: maroon">bundle</span><span style="color: navy">, </span><span style="color: maroon">serviceRequest</span><span style="color: navy">, </span><span style="color: maroon">patient</span><span style="color: navy">)</span> <i>&quot;attachment&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;previousResults&quot;</i><span style="color: navy">;</span>
<span style="color: navy">}

</span><b>group </b>RequestedServiceItems<span style="color: navy">(</span><b>source</b> <span style="color: maroon">src</span>, <b>target</b> <span style="color: maroon">serviceRequest</span><span style="color: navy"> : </span>ServiceRequest<span style="color: navy">)</span><span style="color: navy"> {
</span>  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'requestedService.service') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy"><b> -&gt; </b></span> serviceRequest.category<b> as </b><span style="color: maroon">cc</span><span style="color: navy">, </span> cc.coding = <span style="color: maroon">coding</span> <i>&quot;requestedServiceService&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerCalueCoding&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
<span style="color: navy">}

</span><b>group </b>ReasonServiceItems<span style="color: navy">(</span><b>source</b> <span style="color: maroon">src</span>, <b>target</b> <span style="color: maroon">serviceRequest</span><span style="color: navy"> : </span>ServiceRequest<span style="color: navy">)</span><span style="color: navy"> {
</span>  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'reason.question') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>string<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> serviceRequest.reasonCode<b> as </b><span style="color: maroon">reasonCode</span><span style="color: navy">, </span> reasonCode.text = <span style="color: maroon">value</span> <i>&quot;reasonQuestion&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
<span style="color: navy">}

</span><b>group </b>ImagingServiceItems<span style="color: navy">(</span><b>source</b> <span style="color: maroon">src</span>, <b>target</b> <span style="color: maroon">serviceRequest</span><span style="color: navy"> : </span>ServiceRequest<span style="color: navy">)</span><span style="color: navy"> {
</span>  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'imagingService.type') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy"><b> -&gt; </b></span> serviceRequest.code<b> as </b><span style="color: maroon">code</span><span style="color: navy">, </span> code.coding = <span style="color: maroon">coding</span> <i>&quot;requestedServiceService&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueCoding&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
<span style="color: navy">}

</span><b>group </b>OrderDetailServiceItems<span style="color: navy">(</span><b>source</b> <span style="color: maroon">src</span>, <b>target</b> <span style="color: maroon">serviceRequest</span><span style="color: navy"> : </span>ServiceRequest<span style="color: navy">)</span><span style="color: navy"> {
</span>  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'orderDetail.imagingRegion') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy"><b> -&gt; </b></span> serviceRequest.orderDetail<b> as </b><span style="color: maroon">cc</span><span style="color: navy">, </span> cc.extension<b> as </b><span style="color: maroon">ext</span><span style="color: navy">, </span> ext.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-order-detail-type'</span><span style="color: navy">, </span> ext.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/CodeSystem/ch-rad-order-order-detail-type'</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'imagingRegion'</span><span style="color: navy">, </span> cc.coding = <span style="color: maroon">coding</span> <i>&quot;orderDetailImagingRegion&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueCoding&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'orderDetail.imagingFocus') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy"><b> -&gt; </b></span> serviceRequest.bodySite<b> as </b><span style="color: maroon">cc</span><span style="color: navy">, </span> cc.coding = <span style="color: maroon">coding</span> <i>&quot;orderDetailImagingFocus&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueCoding&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'orderDetail.laterality') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy"><b> -&gt; </b></span> serviceRequest.orderDetail<b> as </b><span style="color: maroon">cc</span><span style="color: navy">, </span> cc.extension<b> as </b><span style="color: maroon">ext</span><span style="color: navy">, </span> ext.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-order-detail-type'</span><span style="color: navy">, </span> ext.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/CodeSystem/ch-rad-order-order-detail-type'</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'laterality'</span><span style="color: navy">, </span> cc.coding = <span style="color: maroon">coding</span> <i>&quot;orderDetailLaterality&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueCoding&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'orderDetail.viewType') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy"><b> -&gt; </b></span> serviceRequest.orderDetail<b> as </b><span style="color: maroon">cc</span><span style="color: navy">, </span> cc.extension<b> as </b><span style="color: maroon">ext</span><span style="color: navy">, </span> ext.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-order-detail-type'</span><span style="color: navy">, </span> ext.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/CodeSystem/ch-rad-order-order-detail-type'</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'viewType'</span><span style="color: navy">, </span> cc.coding = <span style="color: maroon">coding</span> <i>&quot;orderDetailViewType&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueCoding&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'orderDetail.maneuverType') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy"><b> -&gt; </b></span> serviceRequest.orderDetail<b> as </b><span style="color: maroon">cc</span><span style="color: navy">, </span> cc.extension<b> as </b><span style="color: maroon">ext</span><span style="color: navy">, </span> ext.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-order-detail-type'</span><span style="color: navy">, </span> ext.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/CodeSystem/ch-rad-order-order-detail-type'</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'maneuverType'</span><span style="color: navy">, </span> cc.coding = <span style="color: maroon">coding</span> <i>&quot;orderDetailManeuverType&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueCoding&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'orderDetail.guidanceForAction') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy"><b> -&gt; </b></span> serviceRequest.orderDetail<b> as </b><span style="color: maroon">cc</span><span style="color: navy">, </span> cc.extension<b> as </b><span style="color: maroon">ext</span><span style="color: navy">, </span> ext.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-order-detail-type'</span><span style="color: navy">, </span> ext.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/CodeSystem/ch-rad-order-order-detail-type'</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'guidanceForAction'</span><span style="color: navy">, </span> cc.coding = <span style="color: maroon">coding</span> <i>&quot;orderDetailGuidanceForAction&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueCoding&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
<span style="color: navy">}

</span><b>group </b>DesiredRadiologistServiceItems<span style="color: navy">(</span><b>source</b> <span style="color: maroon">src</span>, <b>target</b> <span style="color: maroon">bundle</span><span style="color: navy"> : </span>Bundle, <b>target</b> <span style="color: maroon">serviceRequest</span><span style="color: navy"> : </span>ServiceRequest<span style="color: navy">)</span><span style="color: navy"> {
</span>  src<span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Practitioner'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">practitioner</span><span style="color: navy">, </span> practitioner.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> serviceRequest.performer<b> as </b><span style="color: maroon">performer</span><span style="color: navy">, </span> performer.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><b> then</b><span style="color: navy"> {
</span>    src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'desiredRadiologist.familyName') and answer.exists())<span style="color: navy"><b> -&gt; </b></span> practitioner.name<b> as </b><span style="color: maroon">name</span> <b>share</b> <b>name</b><span style="color: navy">, </span> name.family = <span style="color: navy">(</span>%item.answer.value<span style="color: navy">)</span><span style="color: navy">;</span>
    src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'desiredRadiologist.givenName') and answer.exists())<span style="color: navy"><b> -&gt; </b></span> practitioner.name<b> as </b><span style="color: maroon">name</span> <b>share</b> <b>name</b><span style="color: navy">, </span> name.given = <span style="color: navy">(</span>%item.answer.value<span style="color: navy">)</span><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;serviceRequestPerformer&quot;</i><span style="color: navy">;</span>
<span style="color: navy">}

</span><b>group </b>DiagnosisListServiceItems<span style="color: navy">(</span><b>source</b> <span style="color: maroon">src</span>, <b>target</b> <span style="color: maroon">patient</span><span style="color: navy"> : </span>Patient, <b>target</b> <span style="color: maroon">bundle</span><span style="color: navy"> : </span>Bundle, <b>target</b> <span style="color: maroon">serviceRequest</span><span style="color: navy"> : </span>ServiceRequest<span style="color: navy">)</span><span style="color: navy"> {
</span>  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'diagnosisList.primaryDiagnosis') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>string<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Condition'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">condition</span><span style="color: navy">, </span> condition.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.reasonReference<b> as </b><span style="color: maroon">reasonReference</span><span style="color: navy">, </span> reasonReference.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'problem-list-item'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/condition-category'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Problem List Item'</span><span style="color: navy">, </span> condition.code<b> as </b><span style="color: maroon">code</span><span style="color: navy">, </span> code.text = <span style="color: maroon">value</span><span style="color: navy">, </span> condition.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span> <i>&quot;diagnosisListPrimaryDiagnosis&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'diagnosisList.secondaryDiagnosis') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>string<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Condition'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">condition</span><span style="color: navy">, </span> condition.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'problem-list-item'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/condition-category'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Problem List Item'</span><span style="color: navy">, </span> condition.code<b> as </b><span style="color: maroon">code</span><span style="color: navy">, </span> code.text = <span style="color: maroon">value</span><span style="color: navy">, </span> condition.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span> <i>&quot;diagnosisListSecondaryDiagnosis&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'diagnosisList.bodyHeight') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Quantity<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Observation'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">observation</span><span style="color: navy">, </span> observation.status = <span style="color: blue">'final'</span><span style="color: navy">, </span> observation.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> observation.status = <span style="color: blue">'final'</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> observation.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'vital-signs'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/observation-category'</span><span style="color: navy">, </span> observation.value = <span style="color: maroon">value</span><span style="color: navy">, </span> observation.code<b> as </b><span style="color: maroon">cc</span><span style="color: navy">, </span> cc.coding<b> as </b><span style="color: maroon">c</span><span style="color: navy">, </span> c.system = <span style="color: blue">'http://loinc.org'</span><span style="color: navy">, </span> c.code = <span style="color: blue">'8302-2'</span><span style="color: navy">, </span> observation.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span> <i>&quot;observationBodyHeight&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'diagnosisList.bodyWeight') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Quantity<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Observation'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">observation</span><span style="color: navy">, </span> observation.status = <span style="color: blue">'final'</span><span style="color: navy">, </span> observation.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> observation.status = <span style="color: blue">'final'</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> observation.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'vital-signs'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/observation-category'</span><span style="color: navy">, </span> observation.value = <span style="color: maroon">value</span><span style="color: navy">, </span> observation.code<b> as </b><span style="color: maroon">cc</span><span style="color: navy">, </span> cc.coding<b> as </b><span style="color: maroon">c</span><span style="color: navy">, </span> c.system = <span style="color: blue">'http://loinc.org'</span><span style="color: navy">, </span> c.code = <span style="color: blue">'29463-7'</span><span style="color: navy">, </span> observation.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span> <i>&quot;observationBbodyWeight&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
<span style="color: navy">}

</span><b>group </b>CaveatServiceItems<span style="color: navy">(</span><b>source</b> <span style="color: maroon">src</span>, <b>target</b> <span style="color: maroon">patient</span><span style="color: navy"> : </span>Patient, <b>target</b> <span style="color: maroon">bundle</span><span style="color: navy"> : </span>Bundle, <b>target</b> <span style="color: maroon">serviceRequest</span><span style="color: navy"> : </span>ServiceRequest<span style="color: navy">)</span><span style="color: navy"> {
</span>  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'caveatList.bloodCoagulation') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Condition'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">condition</span><span style="color: navy">, </span> condition.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext1</span><span style="color: navy">, </span> ext1.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-caveat-type'</span><span style="color: navy">, </span> ext1.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'64779008'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Blood coagulation disorder (disorder)'</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext2</span><span style="color: navy">, </span> ext2.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-qualifier-value'</span><span style="color: navy">, </span> ext2.value = <span style="color: maroon">value</span><span style="color: navy">, </span> condition.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'problem-list-item'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/condition-category'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Problem List Item'</span><span style="color: navy">, </span> condition.code<b> as </b><span style="color: maroon">code</span><span style="color: navy">, </span> code.coding<b> as </b><span style="color: maroon">coding2</span><span style="color: navy">, </span> coding2.code = <span style="color: blue">'64779008'</span><span style="color: navy">, </span> coding2.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding2.display = <span style="color: blue">'Blood coagulation disorder (disorder)'</span><span style="color: navy">, </span> condition.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span><b> then</b><span style="color: navy"> {
</span>        answer.item<b> as </b><span style="color: maroon">subitem</span><b> where </b>(linkId.value = 'caveatList.bloodCoagulation.INR')<span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Observation'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">observation</span><span style="color: navy">, </span> observation.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> observation.status = <span style="color: blue">'final'</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.evidence<b> as </b><span style="color: maroon">evidence</span><span style="color: navy">, </span> evidence.detail<b> as </b><span style="color: maroon">detail</span><span style="color: navy">, </span> detail.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> observation.code<b> as </b><span style="color: maroon">cc</span><span style="color: navy">, </span> cc.coding<b> as </b><span style="color: maroon">c</span><span style="color: navy">, </span> c.system = <span style="color: blue">'http://loinc.org'</span><span style="color: navy">, </span> c.code = <span style="color: blue">'34714-6'</span><span style="color: navy">, </span> observation.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span><b> then</b><span style="color: navy"> {
</span>          subitem.item<b> as </b><span style="color: maroon">quantityitem</span><b> where </b>((linkId.value = 'caveatList.bloodCoagulation.INR.quantity') and answer.exists())<b> then</b><span style="color: navy"> {
</span>            quantityitem.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>              answer.value<span style="color: navy"> : </span>Quantity<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span>observation.value = <span style="color: maroon">value</span><span style="color: navy">;</span>
            <span style="color: navy">}</span> <i>&quot;caveatBloodCoagulationINRQuantityValue&quot;</i><span style="color: navy">;</span>
          <span style="color: navy">}</span> <i>&quot;caveatBloodCoagulationINRQuantity&quot;</i><span style="color: navy">;</span>
          subitem.item<b> as </b><span style="color: maroon">datetimeitem</span><b> where </b>((linkId.value = 'caveatList.bloodCoagulation.INR.dateTime') and answer.exists())<b> then</b><span style="color: navy"> {
</span>            datetimeitem.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>              answer.value<span style="color: navy"> : </span>dateTime<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span>observation.effective = <span style="color: maroon">value</span><span style="color: navy">;</span>
            <span style="color: navy">}</span> <i>&quot;caveatBloodCoagulationINRDateTimeValue&quot;</i><span style="color: navy">;</span>
          <span style="color: navy">}</span> <i>&quot;caveatBloodCoagulationINRDateTime&quot;</i><span style="color: navy">;</span>
        <span style="color: navy">}</span> <i>&quot;caveatBloodCoagulationINR&quot;</i><span style="color: navy">;</span>
        answer.item<b> as </b><span style="color: maroon">subitem</span><b> where </b>(linkId.value = 'caveatList.bloodCoagulation.platelets')<span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Observation'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">observation</span><span style="color: navy">, </span> observation.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> observation.status = <span style="color: blue">'final'</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.evidence<b> as </b><span style="color: maroon">evidence</span><span style="color: navy">, </span> evidence.detail<b> as </b><span style="color: maroon">detail</span><span style="color: navy">, </span> detail.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> observation.code<b> as </b><span style="color: maroon">cc</span><span style="color: navy">, </span> cc.coding<b> as </b><span style="color: maroon">c</span><span style="color: navy">, </span> c.system = <span style="color: blue">'http://loinc.org'</span><span style="color: navy">, </span> c.code = <span style="color: blue">'26515-7'</span><span style="color: navy">, </span> observation.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span><b> then</b><span style="color: navy"> {
</span>          subitem.item<b> as </b><span style="color: maroon">quantityitem</span><b> where </b>((linkId.value = 'caveatList.bloodCoagulation.platelets.quantity') and answer.exists())<b> then</b><span style="color: navy"> {
</span>            quantityitem.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>              answer.value<span style="color: navy"> : </span>Quantity<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span>observation.value = <span style="color: maroon">value</span><span style="color: navy">;</span>
            <span style="color: navy">}</span> <i>&quot;caveatBloodCoagulationINRPlateletsValue&quot;</i><span style="color: navy">;</span>
          <span style="color: navy">}</span> <i>&quot;caveatBloodCoagulationINRPlatelets&quot;</i><span style="color: navy">;</span>
          subitem.item<b> as </b><span style="color: maroon">datetimeitem</span><b> where </b>((linkId.value = 'caveatList.bloodCoagulation.platelets.dateTime') and answer.exists())<b> then</b><span style="color: navy"> {
</span>            datetimeitem.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>              answer.value<span style="color: navy"> : </span>dateTime<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span>observation.effective = <span style="color: maroon">value</span><span style="color: navy">;</span>
            <span style="color: navy">}</span> <i>&quot;caveatBloodCoagulationINRPlateletsValue&quot;</i><span style="color: navy">;</span>
          <span style="color: navy">}</span> <i>&quot;caveatBloodCoagulationINRPlatelets&quot;</i><span style="color: navy">;</span>
        <span style="color: navy">}</span> <i>&quot;caveatBloodCoagulationINR&quot;</i><span style="color: navy">;</span>
      <span style="color: navy">}</span> <i>&quot;bloodCoagulation&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'caveatList.renalInsufficiency') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Condition'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">condition</span><span style="color: navy">, </span> condition.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext1</span><span style="color: navy">, </span> ext1.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-caveat-type'</span><span style="color: navy">, </span> ext1.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'723188008'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Renal insufficiency (disorder)'</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext2</span><span style="color: navy">, </span> ext2.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-qualifier-value'</span><span style="color: navy">, </span> ext2.value = <span style="color: maroon">value</span><span style="color: navy">, </span> condition.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'problem-list-item'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/condition-category'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Problem List Item'</span><span style="color: navy">, </span> condition.code<b> as </b><span style="color: maroon">code</span><span style="color: navy">, </span> code.coding<b> as </b><span style="color: maroon">coding2</span><span style="color: navy">, </span> coding2.code = <span style="color: blue">'723188008'</span><span style="color: navy">, </span> coding2.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding2.display = <span style="color: blue">'Renal insufficiency (disorder)'</span><span style="color: navy">, </span> condition.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span><b> then</b><span style="color: navy"> {
</span>        answer.item<b> as </b><span style="color: maroon">subitem</span><b> where </b>(linkId.value = 'caveatList.renalInsufficiency.creatinineClearance')<span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Observation'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">observation</span><span style="color: navy">, </span> observation.status = <span style="color: blue">'final'</span><span style="color: navy">, </span> observation.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.evidence<b> as </b><span style="color: maroon">evidence</span><span style="color: navy">, </span> evidence.detail<b> as </b><span style="color: maroon">detail</span><span style="color: navy">, </span> detail.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> observation.code<b> as </b><span style="color: maroon">cc</span><span style="color: navy">, </span> cc.coding<b> as </b><span style="color: maroon">c</span><span style="color: navy">, </span> c.system = <span style="color: blue">'http://loinc.org'</span><span style="color: navy">, </span> c.code = <span style="color: blue">'33558-8'</span><span style="color: navy">, </span> observation.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span><b> then</b><span style="color: navy"> {
</span>          subitem.item<b> as </b><span style="color: maroon">quantityitem</span><b> where </b>((linkId.value = 'caveatList.renalInsufficiency.creatinineClearance.quantity') and answer.exists())<b> then</b><span style="color: navy"> {
</span>            quantityitem.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>              answer.value<span style="color: navy"> : </span>Quantity<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span>observation.value = <span style="color: maroon">value</span><span style="color: navy">;</span>
            <span style="color: navy">}</span> <i>&quot;caveatListRenalInsufficiencyCreatinineClearanceQuantityValue&quot;</i><span style="color: navy">;</span>
          <span style="color: navy">}</span> <i>&quot;caveatListRenalInsufficiencyCreatinineClearanceQuantity&quot;</i><span style="color: navy">;</span>
          subitem.item<b> as </b><span style="color: maroon">datetimeitem</span><b> where </b>((linkId.value = 'caveatList.renalInsufficiency.creatinineClearance.dateTime') and answer.exists())<b> then</b><span style="color: navy"> {
</span>            datetimeitem.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>              answer.value<span style="color: navy"> : </span>dateTime<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span>observation.effective = <span style="color: maroon">value</span><span style="color: navy">;</span>
            <span style="color: navy">}</span> <i>&quot;caveatListRenalInsufficiencyCreatinineClearanceDateTimeValue&quot;</i><span style="color: navy">;</span>
          <span style="color: navy">}</span> <i>&quot;caveatListRenalInsufficiencyCreatinineClearancedateTime&quot;</i><span style="color: navy">;</span>
        <span style="color: navy">}</span> <i>&quot;caveatListRenalInsufficiencyCreatinineClearanceINR&quot;</i><span style="color: navy">;</span>
        answer.item<b> as </b><span style="color: maroon">subitem</span><b> where </b>(linkId.value = 'caveatList.renalInsufficiency.creatinine')<span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Observation'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">observation</span><span style="color: navy">, </span> observation.status = <span style="color: blue">'final'</span><span style="color: navy">, </span> observation.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.evidence<b> as </b><span style="color: maroon">evidence</span><span style="color: navy">, </span> evidence.detail<b> as </b><span style="color: maroon">detail</span><span style="color: navy">, </span> detail.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> observation.code<b> as </b><span style="color: maroon">cc</span><span style="color: navy">, </span> cc.coding<b> as </b><span style="color: maroon">c</span><span style="color: navy">, </span> c.system = <span style="color: blue">'http://loinc.org'</span><span style="color: navy">, </span> c.code = <span style="color: blue">'77140-2'</span><span style="color: navy">, </span> observation.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span><b> then</b><span style="color: navy"> {
</span>          subitem.item<b> as </b><span style="color: maroon">quantityitem</span><b> where </b>((linkId.value = 'caveatList.renalInsufficiency.creatinine.quantity') and answer.exists())<b> then</b><span style="color: navy"> {
</span>            quantityitem.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>              answer.value<span style="color: navy"> : </span>Quantity<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span>observation.value = <span style="color: maroon">value</span><span style="color: navy">;</span>
            <span style="color: navy">}</span> <i>&quot;caveatListRenalInsufficiencyCreatinineValue&quot;</i><span style="color: navy">;</span>
          <span style="color: navy">}</span> <i>&quot;caveatListRenalInsufficiencyCreatinine&quot;</i><span style="color: navy">;</span>
          subitem.item<b> as </b><span style="color: maroon">datetimeitem</span><b> where </b>((linkId.value = 'caveatList.renalInsufficiency.creatinine.dateTime') and answer.exists())<b> then</b><span style="color: navy"> {
</span>            datetimeitem.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>              answer.value<span style="color: navy"> : </span>dateTime<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span>observation.effective = <span style="color: maroon">value</span><span style="color: navy">;</span>
            <span style="color: navy">}</span> <i>&quot;caveatListRenalInsufficiencyCreatininevalue&quot;</i><span style="color: navy">;</span>
          <span style="color: navy">}</span> <i>&quot;caveatBloodCoagulationINRPlatelets&quot;</i><span style="color: navy">;</span>
        <span style="color: navy">}</span> <i>&quot;caveatListRenalInsufficiencyCreatinine&quot;</i><span style="color: navy">;</span>
      <span style="color: navy">}</span> <i>&quot;bloodCoagulation&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'caveatList.claustrophobia') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Condition'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">condition</span><span style="color: navy">, </span> condition.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext1</span><span style="color: navy">, </span> ext1.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-caveat-type'</span><span style="color: navy">, </span> ext1.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'19887002'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Claustrophobia (finding)'</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext2</span><span style="color: navy">, </span> ext2.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-qualifier-value'</span><span style="color: navy">, </span> ext2.value = <span style="color: maroon">value</span><span style="color: navy">, </span> condition.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'problem-list-item'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/condition-category'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Problem List Item'</span><span style="color: navy">, </span> condition.code<b> as </b><span style="color: maroon">code</span><span style="color: navy">, </span> code.coding<b> as </b><span style="color: maroon">coding2</span><span style="color: navy">, </span> coding2.code = <span style="color: blue">'19887002'</span><span style="color: navy">, </span> coding2.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding2.display = <span style="color: blue">'Claustrophobia (finding)'</span><span style="color: navy">, </span> condition.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span> <i>&quot;caveatListClaustrophobia&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'caveatList.bodyPiercing') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Condition'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">condition</span><span style="color: navy">, </span> condition.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext1</span><span style="color: navy">, </span> ext1.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-caveat-type'</span><span style="color: navy">, </span> ext1.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'879862001'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Body piercing (finding)'</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext2</span><span style="color: navy">, </span> ext2.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-qualifier-value'</span><span style="color: navy">, </span> ext2.value = <span style="color: maroon">value</span><span style="color: navy">, </span> condition.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'problem-list-item'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/condition-category'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Problem List Item'</span><span style="color: navy">, </span> condition.code<b> as </b><span style="color: maroon">code</span><span style="color: navy">, </span> code.coding<b> as </b><span style="color: maroon">coding2</span><span style="color: navy">, </span> coding2.code = <span style="color: blue">'879862001'</span><span style="color: navy">, </span> coding2.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding2.display = <span style="color: blue">'Body piercing (finding)'</span><span style="color: navy">, </span> condition.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span> <i>&quot;caveatListBodyPiercing&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'caveatList.device') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Condition'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">condition</span><span style="color: navy">, </span> condition.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext1</span><span style="color: navy">, </span> ext1.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-caveat-type'</span><span style="color: navy">, </span> ext1.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'397578001'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Device in situ (finding)'</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext2</span><span style="color: navy">, </span> ext2.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-qualifier-value'</span><span style="color: navy">, </span> ext2.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'52101004'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Present (qualifier value)'</span><span style="color: navy">, </span> condition.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'problem-list-item'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/condition-category'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Problem List Item'</span><span style="color: navy">, </span> condition.code<b> as </b><span style="color: maroon">code</span><span style="color: navy">, </span> code.coding = <span style="color: maroon">value</span><span style="color: navy">, </span> condition.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span> <i>&quot;caveatListDevice&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'caveatList.hyperthyroidism') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Condition'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">condition</span><span style="color: navy">, </span> condition.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext1</span><span style="color: navy">, </span> ext1.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-caveat-type'</span><span style="color: navy">, </span> ext1.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'34486009'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Hyperthyroidism (disorder)'</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext2</span><span style="color: navy">, </span> ext2.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-qualifier-value'</span><span style="color: navy">, </span> ext2.value = <span style="color: maroon">value</span><span style="color: navy">, </span> condition.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'problem-list-item'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/condition-category'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Problem List Item'</span><span style="color: navy">, </span> condition.code<b> as </b><span style="color: maroon">code</span><span style="color: navy">, </span> code.coding<b> as </b><span style="color: maroon">coding2</span><span style="color: navy">, </span> coding2.code = <span style="color: blue">'34486009'</span><span style="color: navy">, </span> coding2.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding2.display = <span style="color: blue">'Hyperthyroidism (disorder)'</span><span style="color: navy">, </span> condition.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span> <i>&quot;caveatListHyperthyroidism&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'caveatList.diabetes') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Condition'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">condition</span><span style="color: navy">, </span> condition.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext1</span><span style="color: navy">, </span> ext1.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-caveat-type'</span><span style="color: navy">, </span> ext1.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'73211009'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Diabetes mellitus (disorder)'</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext2</span><span style="color: navy">, </span> ext2.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-qualifier-value'</span><span style="color: navy">, </span> ext2.value = <span style="color: maroon">value</span><span style="color: navy">, </span> condition.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'problem-list-item'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/condition-category'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Problem List Item'</span><span style="color: navy">, </span> condition.code<b> as </b><span style="color: maroon">code</span><span style="color: navy">, </span> code.coding<b> as </b><span style="color: maroon">coding2</span><span style="color: navy">, </span> coding2.code = <span style="color: blue">'73211009'</span><span style="color: navy">, </span> coding2.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding2.display = <span style="color: blue">'Diabetes mellitus (disorder)'</span><span style="color: navy">, </span> condition.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span> <i>&quot;caveatListDiabetes&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'caveatList.gravida') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Condition'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">condition</span><span style="color: navy">, </span> condition.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext1</span><span style="color: navy">, </span> ext1.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-caveat-type'</span><span style="color: navy">, </span> ext1.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'366321006'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Finding of gravida (finding)'</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext2</span><span style="color: navy">, </span> ext2.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-qualifier-value'</span><span style="color: navy">, </span> ext2.value = <span style="color: maroon">value</span><span style="color: navy">, </span> condition.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'problem-list-item'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/condition-category'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Problem List Item'</span><span style="color: navy">, </span> condition.code<b> as </b><span style="color: maroon">code</span><span style="color: navy">, </span> code.coding<b> as </b><span style="color: maroon">coding2</span><span style="color: navy">, </span> coding2.code = <span style="color: blue">'366321006'</span><span style="color: navy">, </span> coding2.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding2.display = <span style="color: blue">'Finding of gravida (finding)'</span><span style="color: navy">, </span> condition.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span> <i>&quot;caveatListGravida&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>((linkId.value = 'caveatList.contrastMediaAllergy') and answer.exists())<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Condition'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">condition</span><span style="color: navy">, </span> condition.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext1</span><span style="color: navy">, </span> ext1.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-caveat-type'</span><span style="color: navy">, </span> ext1.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'293637006'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Allergy to contrast media (finding)'</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext2</span><span style="color: navy">, </span> ext2.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-qualifier-value'</span><span style="color: navy">, </span> ext2.value = <span style="color: maroon">value</span><span style="color: navy">, </span> condition.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'problem-list-item'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/condition-category'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Problem List Item'</span><span style="color: navy">, </span> condition.code<b> as </b><span style="color: maroon">code</span><span style="color: navy">, </span> code.coding<b> as </b><span style="color: maroon">coding2</span><span style="color: navy">, </span> coding2.code = <span style="color: blue">'293637006'</span><span style="color: navy">, </span> coding2.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding2.display = <span style="color: blue">'Allergy to contrast media (finding)'</span><span style="color: navy">, </span> condition.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span> <i>&quot;caveatListContrastMediaAllergy&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">// </span><span style="color: green">&quot;caveatListDrugPrescription.metformin&quot;</span>
  <span style="color: navy">// </span><span style="color: green">caveatList.drugPrescription.betaBlocke</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>(linkId.value = 'caveatList.drugPrescription')<b> then </b>DesiredRadiologistServiceItemsDrugDescription<span style="color: navy">(</span><span style="color: maroon">item</span><span style="color: navy">, </span><span style="color: maroon">bundle</span><span style="color: navy">, </span><span style="color: maroon">serviceRequest</span><span style="color: navy">, </span><span style="color: maroon">patient</span><span style="color: navy">)</span> <i>&quot;DrugPrescription&quot;</i><span style="color: navy">;</span>
<span style="color: navy">}

</span><b>group </b>DesiredRadiologistServiceItemsDrugDescription<span style="color: navy">(</span><b>source</b> <span style="color: maroon">src</span>, <b>target</b> <span style="color: maroon">bundle</span><span style="color: navy"> : </span>Bundle, <b>target</b> <span style="color: maroon">serviceRequest</span><span style="color: navy"> : </span>ServiceRequest, <b>target</b> <span style="color: maroon">patient</span><span style="color: navy"> : </span>Patient<span style="color: navy">)</span><span style="color: navy"> {
</span>  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>(linkId.value = 'caveatList.drugPrescription.metformin')<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Condition'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">condition</span><span style="color: navy">, </span> condition.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext1</span><span style="color: navy">, </span> ext1.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-caveat-type'</span><span style="color: navy">, </span> ext1.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'182817000'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Drug prescription (situation)'</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext2</span><span style="color: navy">, </span> ext2.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-qualifier-value'</span><span style="color: navy">, </span> ext2.value = <span style="color: maroon">value</span><span style="color: navy">, </span> condition.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'problem-list-item'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/condition-category'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Problem List Item'</span><span style="color: navy">, </span> condition.code<b> as </b><span style="color: maroon">code</span><span style="color: navy">, </span> code.coding<b> as </b><span style="color: maroon">coding2</span><span style="color: navy">, </span> coding2.code = <span style="color: blue">'372567009'</span><span style="color: navy">, </span> coding2.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding2.display = <span style="color: blue">'Metformin (substance)'</span><span style="color: navy">, </span> condition.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span> <i>&quot;caveatListDrugPrescription&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;caveatListDrugPrescriptionMetformin&quot;</i><span style="color: navy">;</span>
  src.item<b> as </b><span style="color: maroon">item</span><b> where </b>(linkId.value = 'caveatList.drugPrescription.betaBlocker')<b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>Coding<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Condition'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">condition</span><span style="color: navy">, </span> condition.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> e.fullUrl = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext1</span><span style="color: navy">, </span> ext1.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-caveat-type'</span><span style="color: navy">, </span> ext1.value = <b>create</b><span style="color: navy">(</span><span style="color: blue">'Coding'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'182817000'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Drug prescription (situation)'</span><span style="color: navy">, </span> condition.extension<b> as </b><span style="color: maroon">ext2</span><span style="color: navy">, </span> ext2.url = <span style="color: blue">'http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-qualifier-value'</span><span style="color: navy">, </span> ext2.value = <span style="color: maroon">value</span><span style="color: navy">, </span> condition.category<b> as </b><span style="color: maroon">category</span><span style="color: navy">, </span> category.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'problem-list-item'</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/condition-category'</span><span style="color: navy">, </span> coding.display = <span style="color: blue">'Problem List Item'</span><span style="color: navy">, </span> condition.code<b> as </b><span style="color: maroon">code</span><span style="color: navy">, </span> code.coding<b> as </b><span style="color: maroon">coding2</span><span style="color: navy">, </span> coding2.code = <span style="color: blue">'373254001'</span><span style="color: navy">, </span> coding2.system = <span style="color: blue">'http://snomed.info/sct'</span><span style="color: navy">, </span> coding2.display = <span style="color: blue">'Substance with beta adrenergic receptor antagonist mechanism of action (substance)'</span><span style="color: navy">, </span> condition.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span> <i>&quot;caveatListDrugPrescription&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;caveatListDrugPrescriptionBetaBlocker&quot;</i><span style="color: navy">;</span>
<span style="color: navy">}

</span><b>group </b>PreviousImagingStudyResultsNonDicom<span style="color: navy">(</span><b>source</b> <span style="color: maroon">item</span>, <b>target</b> <span style="color: maroon">bundle</span><span style="color: navy"> : </span>Bundle, <b>target</b> <span style="color: maroon">serviceRequest</span><span style="color: navy"> : </span>ServiceRequest, <b>target</b> <span style="color: maroon">patient</span><span style="color: navy"> : </span>Patient<span style="color: navy">)</span><span style="color: navy"> {
</span>  item<b> as </b><span style="color: maroon">item</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'DocumentReference'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">documentReference</span><span style="color: navy">, </span> documentReference.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> documentReference.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span><span style="color: navy">, </span> e.fullUrl = <b>append</b><span style="color: navy">(</span><span style="color: blue">'urn:uuid:'</span><span style="color: navy">, </span><span style="color: maroon">uuid</span><span style="color: navy">)</span><span style="color: navy">, </span> documentReference.status = <span style="color: blue">'current'</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><span style="color: navy"><b> -&gt; </b></span> documentReference.content<b> as </b><span style="color: maroon">content</span><span style="color: navy">, </span> content.attachment = <span style="color: navy">(</span>%answer.value<span style="color: navy">)</span><b> as </b><span style="color: maroon">attachment</span><b> then</b><span style="color: navy"> {
</span>      answer.item<b> as </b><span style="color: maroon">dictomitem</span><b> where </b>((linkId.value = 'attachedFile.description') and answer.exists())<span style="color: navy"><b> -&gt; </b></span>documentReference.description = <span style="color: navy">(</span>%dictomitem.answer.value<span style="color: navy">)</span> <i>&quot;description&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;itemAnswer&quot;</i><span style="color: navy">;</span>
<span style="color: navy">}

</span><b>group </b>PreviousImagingStudyResults<span style="color: navy">(</span><b>source</b> <span style="color: maroon">item</span>, <b>target</b> <span style="color: maroon">bundle</span><span style="color: navy"> : </span>Bundle, <b>target</b> <span style="color: maroon">serviceRequest</span><span style="color: navy"> : </span>ServiceRequest, <b>target</b> <span style="color: maroon">patient</span><span style="color: navy"> : </span>Patient<span style="color: navy">)</span><span style="color: navy"> {
</span>  item<b> as </b><span style="color: maroon">item</span><span style="color: navy"><b> -&gt; </b></span> bundle.entry<b> as </b><span style="color: maroon">e</span><span style="color: navy">, </span> e.resource = <b>create</b><span style="color: navy">(</span><span style="color: blue">'ImagingStudy'</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">imagingStudy</span><span style="color: navy">, </span> imagingStudy.id = <b>uuid</b><span style="color: navy">(</span><span style="color: navy">)</span><b> as </b><span style="color: maroon">uuid</span><span style="color: navy">, </span> imagingStudy.status = <span style="color: blue">'available'</span><span style="color: navy">, </span> imagingStudy.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span><span style="color: navy">, </span> e.fullUrl = <b>append</b><span style="color: navy">(</span><span style="color: blue">'urn:uuid:'</span><span style="color: navy">, </span><span style="color: maroon">uuid</span><span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.subject<b> as </b><span style="color: maroon">subject</span><span style="color: navy">, </span> subject.reference = <span style="color: navy">(</span>'urn:uuid:' + %patient.id<span style="color: navy">)</span><span style="color: navy">, </span> serviceRequest.supportingInfo<b> as </b><span style="color: maroon">supportingInfo</span><span style="color: navy">, </span> imagingStudy.series<b> as </b><span style="color: maroon">series</span><span style="color: navy">, </span> series.instance<b> as </b><span style="color: maroon">instance</span><span style="color: navy">, </span> supportingInfo.reference = <span style="color: navy">(</span>'urn:uuid:' + %uuid<span style="color: navy">)</span><b> then</b><span style="color: navy"> {
</span>    item.answer<b> as </b><span style="color: maroon">answer</span><b> then</b><span style="color: navy"> {
</span>      answer.value<span style="color: navy"> : </span>string<b> as </b><span style="color: maroon">value</span><span style="color: navy"><b> -&gt; </b></span>imagingStudy.description = <span style="color: maroon">value</span> <i>&quot;description&quot;</i><span style="color: navy">;</span>
    <span style="color: navy">}</span> <i>&quot;answerValueString&quot;</i><span style="color: navy">;</span>
    item.item<b> as </b><span style="color: maroon">item</span><b> where </b>(linkId.value = 'dicomObject.sopInstanceUid') and answer.exists()<span style="color: navy"><b> -&gt; </b></span>instance.uid = <span style="color: navy">(</span>%item.answer.value<span style="color: navy">)</span> <i>&quot;uid&quot;</i><span style="color: navy">;</span>
    item.item<b> as </b><span style="color: maroon">item</span><b> where </b>(linkId.value = 'dicomObject.modality') and answer.exists()<span style="color: navy"><b> -&gt; </b></span> series.modality<b> as </b><span style="color: maroon">modality</span><span style="color: navy">, </span> modality.code = <span style="color: navy">(</span>%item.answer.value.code<span style="color: navy">)</span> <i>&quot;modality&quot;</i><span style="color: navy">;</span>
    item.item<b> as </b><span style="color: maroon">item</span><b> where </b>(linkId.value = 'dicomObject.studyInstanceUid') and answer.exists()<span style="color: navy"><b> -&gt; </b></span> imagingStudy.identifier<b> as </b><span style="color: maroon">uid</span><span style="color: navy">, </span> uid.type<b> as </b><span style="color: maroon">type</span><span style="color: navy">, </span> type.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'urn:dicom:uid'</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'PLAC'</span><span style="color: navy">, </span> uid.value = <span style="color: navy">(</span>%item.answer.value<span style="color: navy">)</span> <i>&quot;uid&quot;</i><span style="color: navy">;</span>
    item.item<b> as </b><span style="color: maroon">item</span><b> where </b>(linkId.value = 'dicomObject.SeriesInstanceUid') and answer.exists()<span style="color: navy"><b> -&gt; </b></span>series.uid = <span style="color: navy">(</span>%item.answer.value<span style="color: navy">)</span> <i>&quot;attachmentdicomSeriesInstanceUid&quot;</i><span style="color: navy">;</span>
    item.item<b> as </b><span style="color: maroon">item</span><b> where </b>(linkId.value = 'dicomObject.acsn') and answer.exists()<span style="color: navy"><b> -&gt; </b></span> imagingStudy.identifier<b> as </b><span style="color: maroon">acsn</span><span style="color: navy">, </span> acsn.type<b> as </b><span style="color: maroon">type</span><span style="color: navy">, </span> type.coding<b> as </b><span style="color: maroon">coding</span><span style="color: navy">, </span> coding.system = <span style="color: blue">'http://terminology.hl7.org/CodeSystem/v2-0203'</span><span style="color: navy">, </span> coding.code = <span style="color: blue">'ACSN'</span><span style="color: navy">, </span> acsn.value = <span style="color: navy">(</span>%item.answer.value<span style="color: navy">)</span> <i>&quot;acsn&quot;</i><span style="color: navy">;</span>
  <span style="color: navy">}</span> <i>&quot;supportingInfo&quot;</i><span style="color: navy">;</span>
<span style="color: navy">}

</span></pre></div>

  <!-- insert notes if present -->
  



  

</div>
        </div>  <!-- /inner-wrapper -->
      </div>  <!-- /row -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-content -->

  <script type="text/javascript" src="assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script type="text/javascript" src="assets/js/jquery-ui.min.js"> </script>

  <script type="text/javascript" src="assets/js/window-hash.js"> </script>
  <a name="bottom"> </a>
  <div id="segment-footer" igtool="footer" class="segment">  <!-- segment-footer -->
    <div class="container">  <!-- container -->

      <div class="inner-wrapper">
        <p>
          IG &#169; 2021+ <a style="color:var(--footer-hyperlink-text-color)" href="https://www.hl7.ch">HL7 Switzerland</a>.  Package ch.fhir.ig.ch-rad-order#2.0.0 based on <a style="color: var(--footer-hyperlink-text-color)" href="http://hl7.org/fhir/R4/">FHIR 4.0.1</a>. Generated <span title="Wed, Dec 18, 2024 10:05+0000">2024-12-18</span>
          <br/>
          <span style="color: var(--footer-highlight-text-color)">
                      Links: <a style="color: var(--footer-hyperlink-text-color)" href="toc.html">Table of Contents</a> |
                 <a style="color: var(--footer-hyperlink-text-color)" href="qa.html">QA Report</a>
                 
                

| <a style="color: #81BEF7" target="_blank" href="https://docs.google.com/forms/d/e/1FAIpQLSdNCGaS-ZHfitfCs7PjaLjw6Jt1scmgipyRf0HFrHbRO2EtZg/viewform?usp=sf_link&amp;entry%2E1353807103=ch.fhir.ig.ch-rad-order%232.0.0%20/StructureMap-RadOrderQrToBundle.html&amp;entry%2E247644557=RadOrderQrToBundle">Propose a change</a>




          </span>
        </p>
      </div>  <!-- /inner-wrapper -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
    <div class="container">  <!-- container -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-post-footer -->

  <!-- JS and analytics only. -->
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="assets/js/bootstrap.min.js"> </script>
  <script type="text/javascript" src="assets/js/respond.min.js"> </script>
  <script type="text/javascript" src="assets/js/anchor.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard-btn.js"> </script>
  <script type="text/javascript" src="assets/js/anchor-hover.js"> </script>
  <!-- Analytics Below
  ================================================== -->
  </body>
</html>

