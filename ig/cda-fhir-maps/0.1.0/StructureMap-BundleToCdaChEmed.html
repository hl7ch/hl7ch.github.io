<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
    <title>CH.FHIR.IG.CDA-FHIR-MAPS\Bundle to CDA-CH-EMED - FHIR v4.0.1</title>
  
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link href="fhir.css" rel="stylesheet"/>
     
    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.css" rel="stylesheet"/>
    <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>
  
    <!-- Project extras -->
    <link href="assets/css/project.css" rel="stylesheet"/>
    <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
    <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
    <!-- Placeholder for child template CSS declarations -->
    <link href="assets/css/hl7.css" rel="stylesheet"/>
    <link href="assets/css/fhir.css" rel="stylesheet"/>

    <script type="text/javascript" src="fhir-table-scripts.js"> </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->
  
    <!-- Favicons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png"/>
    <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body>

    <style type="text/css">h2{--heading-prefix:"3.14"}
    h3,h4,h5,h6{--heading-prefix:"3.14"}</style>
    <div id="segment-header" class="segment">  <!-- segment-header -->
      <div class="container">  <!-- container -->
        
            <!--
<div id="family-nav">
	<a id="logo" no-external="true" href="http://hl7.org/fhir"> <img
		alt="logo fhir" src="assets/images/fhir-logo-www.png" />
	</a>
</div>
-->


            <!--
<div id="hl7-nav">
    <a id="hl7-logo" no-external="true" href="http://www.hl7.ch">
        <img alt="visit the hl7 website" height="50" src="assets/images/hl7-logo.png" />
    </a>            
</div>
-->

        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">CDA-FHIR-Maps (R4)</span><br/>0.1.0 - Draft Standard for Trial Use</p>
        </div>
      </div> <!-- /container -->
    </div>  <!-- /segment-header -->
    
    <div id="segment-navbar" class="segment">  <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">  <!-- container -->
        <!-- HEADER CONTENT -->
    
        <nav class="navbar navbar-inverse">
          <!--status-bar-->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <ul xmlns="http://www.w3.org/1999/xhtml" class="nav navbar-nav">
  <!--<li><a href="toc.html">Table of Contents</a></li>-->
  <li><a href="index.html">Home</a></li>
  <li><a href="maps.html">Maps</a></li>
  <li><a href="artifacts.html">Artifacts</a></li>
</ul>
            </div>  <!-- /.nav-collapse -->
          </div>  <!-- /.container -->
        </nav>  <!-- /.navbar -->
      <!-- /HEADER CONTENT -->
      </div>  <!-- /container -->
    </div>  <!-- /segment-navbar -->
    <!--status-bar-->
    <div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
      <div class="container">  <!-- container -->  
        <ul class="breadcrumb">
          <li><a href='toc.html'><b>Table of Contents</b></a></li><li><a href='artifacts.html'><b>Artifacts Summary</b></a></li><li><b>Bundle to CDA-CH-EMED</b></li>
        </ul>  
      </div>  <!-- /container -->
    </div>  <!-- /segment-breadcrumb -->
    
    <div id="segment-content" class="segment">  <!-- segment-content -->
      <div class="container">  <!-- container -->
        <div class="row">
          <div class="inner-wrapper">



<div class="col-12">
  <!--ReleaseHeader--><p id="publish-box">This page is part of the CDA-FHIR-Maps (R4) (v0.1.0: <a href="https://confluence.hl7.org/display/HL7/HL7+Balloting" title="Draft Standard for Trial-Use">DSTU</a> 1) based on <a href="http://hl7.org/fhir/R4">FHIR R4</a>. .  For a full list of available versions, see the <a href="http://fhir.ch/ig/cda-fhir-maps/history.html">Directory of published versions <img src="external.png" style="text-align: baseline"></a></p><!--EndReleaseHeader-->
  <a name="root"> </a>
  <h2 id="root">Bundle to CDA-CH-EMED</h2>
  <p>
    Format(s):
  </p>
  <ul>

    <li>
      <a href="StructureMap-BundleToCdaChEmed.xml.html">XML</a>
    </li>


    <li>
      <a href="StructureMap-BundleToCdaChEmed.json.html">JSON</a> 
    </li>


    <li>
      <a href="StructureMap-BundleToCdaChEmed.ttl.html">Turtle</a>
    </li>

  </ul>

  
  

  <p>
    <b>Narrative view</b>
  </p>
  <div xmlns="http://www.w3.org/1999/xhtml">
         <pre>map &quot;http://fhir.ch/ig/cda-fhir-maps/StructureMap/BundleToCdaChEmed&quot; = &quot;BundleToCdaChEmed&quot;

// Medication Entries
// 2020-11-11 Michaela Ziegler, copyright ahdis ag, Apache License
// CDA-CH-EMED:  https://art-decor.org/art-decor/decor-project--cdachemed-
// FHIR CH-EMED: http://fhir.ch/ig/ch-emed/index.html

uses &quot;http://hl7.org/fhir/cda/StructureDefinition/ClinicalDocument&quot; alias ClinicalDocument as target
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/AssignedAuthor&quot; alias AssignedAuthor as target
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/AssignedEntity&quot; alias AssignedEntity as target
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/Author&quot; alias Author as target
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/CustodianOrganization&quot; alias CustodianOrganization as target
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/IVL_TS&quot; alias IVL_TS as target
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/EIVL_TS&quot; alias EIVL_TS as target
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/PatientRole&quot; alias PatientRole as target
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/RecordTarget&quot; alias RecordTarget as target
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/Section&quot; alias Section as target
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/SubstanceAdministration&quot; alias SubstanceAdministration as target
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/SXPR_TS&quot; alias SXPR_TS as target
uses &quot;http://hl7.org/fhir/cda/StructureDefinition/Supply&quot; alias Supply as target
uses &quot;http://hl7.org/fhir/StructureDefinition/Bundle&quot; alias Bundle as source
uses &quot;http://hl7.org/fhir/StructureDefinition/Composition&quot; alias Composition as source
uses &quot;http://hl7.org/fhir/StructureDefinition/Patient&quot; alias Patient as source
uses &quot;http://hl7.org/fhir/StructureDefinition/Practitioner&quot; alias Practitioner as source
uses &quot;http://hl7.org/fhir/StructureDefinition/Organization&quot; alias Organization as source
uses &quot;http://hl7.org/fhir/StructureDefinition/MedicationStatement&quot; alias MedicationStatement as source
uses &quot;http://hl7.org/fhir/StructureDefinition/Dosage&quot; alias Dosage as source

imports &quot;http://fhir.ch/ig/cda-fhir-maps/StructureMap/FhirToCdaTypes&quot;
imports &quot;http://fhir.ch/ig/cda-fhir-maps/StructureMap/BundleToCda&quot;
imports &quot;http://fhir.ch/ig/cda-fhir-maps/StructureMap/BundleToCdaCh&quot;

// source: Annotation note (e.g. http://build.fhir.org/ig/hl7ch/ch-emed/branches/master/StructureDefinition-ch-emed-medicationstatement.html)
// target: https://art-decor.org/art-decor/decor-templates--cdachemed-?section=templates&amp;id=2.16.756.5.30.1.1.10.4.2
// Note/Warning: we assume that there is a narrativeLink extension which refers to the text which should be the same as in note.text
group AnnotationComment(source note : Annotation, target act : Act) {
  note -&gt; act.classCode = 'ACT' &quot;ACT&quot;;
  note -&gt; act.moodCode = 'EVN' &quot;EVN&quot;;
  note -&gt;  act.templateId as templateId,  templateId.root = '2.16.756.5.30.1.1.10.4.2' &quot;templateId&quot;;
  note -&gt;  act.templateId as templateId,  templateId.root = '2.16.840.1.113883.10.20.1.40' &quot;templateId&quot;;
  note -&gt;  act.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.5.3.1.4.2' &quot;templateId&quot;;
  note -&gt;  act.code as code,  code.code = '48767-8',  code.codeSystem = '2.16.840.1.113883.6.1',  code.displayName = 'Annotation comment',  code.codeSystemName = 'LOINC' &quot;code&quot;;
  note.extension as extension where $this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink' then {
    extension.valueUrl as valueUrl -&gt;  act.text as text,  text.reference as reference,  reference.value = valueUrl &quot;reference&quot;;
  } &quot;id&quot;;
  note -&gt;  act.statusCode as code,  code.code = 'completed' &quot;statusCode&quot;;
}

// source: http://build.fhir.org/ig/hl7ch/ch-emed/branches/master/StructureDefinition-ch-emed-medicationstatement.html
// target: https://art-decor.org/art-decor/decor-templates--cdachemed-?section=templates&amp;id=2.16.756.5.30.1.1.10.4.33&amp;effectiveDate=2019-12-11T11:34:24&amp;language=en-US
group ManufacturedMaterialEntryContentModuleStatement(source bundle : Bundle, source medicationStatement : MedicationStatement, source medication : Medication, target manufacturedMaterial : ManufacturedMaterial) {
  medication -&gt; manufacturedMaterial.classCode = 'MMAT' &quot;MMAT&quot;;
  medication -&gt; manufacturedMaterial.determinerCode = 'KIND' &quot;KIND&quot;;
  medication -&gt;  manufacturedMaterial.templateId as templateId,  templateId.root = '2.16.756.5.30.1.1.10.4.33' &quot;CH-PHARM-ManufacturedMaterialContentModule&quot;;
  medication -&gt;  manufacturedMaterial.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.1' &quot;templateId&quot;;
  medication.code as code then {
    code.text as text -&gt;  manufacturedMaterial.name as name,  name.other = text &quot;brandname&quot;;
  } &quot;name&quot;;
  medication.code as code then {
    // #mtpc.no.brandedmedication
    code.extension as extension where $this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink' -&gt; manufacturedMaterial.code as code then {
      extension.valueUrl as valueUrl -&gt;  code.originalText as text,  text.reference as reference,  reference.value = valueUrl &quot;reference&quot;;
    } &quot;id&quot;;
    code.coding as coding -&gt; manufacturedMaterial.code as ce then CodingCE(coding, ce) &quot;code&quot;;
  };
  medication.form as form then {
    form.coding as coding -&gt; manufacturedMaterial.formCode as formCode then CodingCE(coding, formCode) &quot;formCode&quot;;
  };
  medication.code as code -&gt;  manufacturedMaterial.asContent as asContent,  asContent.classCode = 'CONT',  asContent.containerPackagedMedicine as containerPackagedMedicine then {
    code -&gt; containerPackagedMedicine.classCode = 'CONT' &quot;CONT&quot;;
    code -&gt; containerPackagedMedicine.determinerCode = 'INSTANCE' &quot;INSTANCE&quot;;
    code.coding as coding -&gt; containerPackagedMedicine.code as ce then CodingCE(coding, ce) &quot;pharm-code&quot;;
    code.text as text -&gt;  containerPackagedMedicine.name as name,  name.other = text &quot;pharm-name&quot;;
    medication.form as form then {
      form.coding as coding -&gt; containerPackagedMedicine.formCode as formCode then CodingCE(coding, formCode) &quot;pharm-formCode&quot;;
    };
    // Package size
    medication.amount as amount then {
      amount.numerator as numerator then {
        // if the value of numerator.code is &quot;1&quot;, then it is not a UCUM code, so generate case 1
        numerator.code as code where $this = '1' -&gt; containerPackagedMedicine.capacityQuantity as capacityQuantity then {
          numerator.value as value -&gt; capacityQuantity.value = value;
        } &quot;noUcum&quot;;
        // if the value of numerator.code is not &quot;1&quot;, then it is a UCUM code, so generate case 2
        numerator.code as code where $this != '1' -&gt; containerPackagedMedicine.capacityQuantity as capacityQuantity then {
          numerator.value as value -&gt; capacityQuantity.value = value;
          numerator.unit as unit -&gt; capacityQuantity.unit = unit;
        } &quot;ucum&quot;;
        // if there ist no numerator.code, case 1 is generated, because no unit exists
        numerator as numerator where $this.code.exists() = false -&gt; containerPackagedMedicine.capacityQuantity as capacityQuantity then {
          numerator.value as value -&gt; capacityQuantity.value = value;
        } &quot;noUcum&quot;;
      };
    };
  };
  medication.ingredient as ingredient -&gt;  manufacturedMaterial.ingredient as ingredient,  ingredient.classCode = 'ACTI' then {
    ingredient.itemCodeableConcept as itemCodeableConcept -&gt; ingredient.ingredient as pharmsubstance then {
      itemCodeableConcept -&gt; pharmsubstance.classCode = 'MMAT' &quot;MMAT&quot;;
      itemCodeableConcept -&gt; pharmsubstance.determinerCode = 'KIND' &quot;KIND&quot;;
      itemCodeableConcept.text as text -&gt;  pharmsubstance.name as name,  name.other = text &quot;name&quot;;
      itemCodeableConcept.coding as coding then {
        coding -&gt; pharmsubstance.code as ce then CodingCE(coding, ce) &quot;formCode&quot;;
      };
    } &quot;PharmSubstance&quot;;
    ingredient.strength as strength -&gt; ingredient.quantity as quantity then RatioRTOPQPQ(strength, quantity);
  };
}

// source: http://build.fhir.org/ig/hl7ch/ch-emed/branches/master/StructureDefinition-ch-emed-medicationstatement.html
// target: https://art-decor.org/art-decor/decor-templates--cdachemed-?section=templates&amp;id=2.16.756.5.30.1.1.10.4.34&amp;effectiveDate=2019-12-11T11:31:52&amp;language=en-US
group MedicationTreatmentPlanItemEntryContentModule(source bundle : Bundle, source medicationStatement : MedicationStatement, target substanceAdministration : SubstanceAdministration) {
  medicationStatement -&gt; substanceAdministration.classCode = 'SBADM' &quot;SBADM&quot;;
  medicationStatement -&gt; substanceAdministration.moodCode = 'INT' &quot;INT&quot;;
  medicationStatement -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '2.16.756.5.30.1.1.10.4.34' &quot;CH-PHARM-MedicationTreatmentPlanItemEntryContentModule&quot;;
  medicationStatement -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.7' &quot;IHE-PHARM-MTP&quot;;
  medicationStatement -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '2.16.840.1.113883.10.20.1.24' &quot;CCD&quot;;
  medicationStatement -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.5.3.1.4.7' &quot;PCC-MedicationEntryContentModule&quot;;
  medicationStatement.identifier as identifier -&gt; substanceAdministration.id as id then IdentifierII(identifier, id) &quot;id&quot;;
  medicationStatement.extension as extension where $this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink' -&gt;  substanceAdministration.text as text,  text.reference as reference then {
    extension.valueUrl as valueUrl -&gt; reference.value = valueUrl;
  } &quot;narrativeLink&quot;;
  medicationStatement -&gt;  substanceAdministration.statusCode as statusCode,  statusCode.code = 'completed' &quot;code&quot;;
  medicationStatement.contained as medication where ('#' + $this.id) in %medicationStatement.medicationReference.reference -&gt;  substanceAdministration.consumable as consumable,  consumable.manufacturedProduct as manufacturedProduct,  manufacturedProduct.classCode = 'MANU' then {
    medication -&gt;  manufacturedProduct.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.5.3.1.4.7.2' &quot;MP-TemplateId&quot;;
    medication -&gt;  manufacturedProduct.templateId as templateId,  templateId.root = '2.16.840.1.113883.10.20.1.53' &quot;MP-TemplateId&quot;;
    medication -&gt; manufacturedProduct.manufacturedMaterial as manufacturedMaterial then ManufacturedMaterialEntryContentModuleStatement(bundle, medicationStatement, medication, manufacturedMaterial) &quot;manufacturedMaterial&quot;;
  };
  // TODO: AUTHOR1 Medication Treatment Plan Author
  medicationStatement.dosage as dosage where $this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured') and $this.sequence.empty() then DosageInstructionsStartStopFrequencySubstanceAdministration(dosage, substanceAdministration) &quot;DosageSubstanceAdministration&quot;;
  // dosage for split dosing (with sequences): effectiveTime (start/stop) &amp; routeCode
  medicationStatement.dosage first as dosage where $this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured') and $this.sequence.exists() -&gt; substanceAdministration.entryRelationship as entryRelationship then DosageInstructionsEntryStartStopRoute(dosage, substanceAdministration, entryRelationship) &quot;DosageSubstanceAdministration&quot;;
  // dosage for split dosing (with sequences): sequence number, effectiveTime (when), dose quantity, consumable
  medicationStatement.dosage as dosage where $this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured') and $this.sequence.exists() -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'COMP' then DosageInstructionsEntryDosageChangeSubstanceAdministration(dosage, substanceAdministration, entryRelationship) &quot;DosageSubstanceAdministration&quot;;
  medicationStatement.reasonCode as reasonCode -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'RSON',  entryRelationship.observation as observation then TreatmentReasonEntryContentModule(reasonCode, observation) &quot;TreatmentReasonEntryContentModule&quot;;
  medicationStatement.extension as extension where url = 'http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-ext-treatmentplan' -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'REFR',  entryRelationship.substanceAdministration as substanceAdministration then MTPReferenceEntryContentModule(extension, substanceAdministration) &quot;MTP-Reference&quot;;
  // TODO: Patient Medication Instructions Contains 1.3.6.1.4.1.19376.1.5.3.1.4.3 IHE Patient Medication Instructions (DYNAMIC)
  medicationStatement.dosage as dosage where $this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-nonstructured') -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'COMP',  entryRelationship.substanceAdministration as substanceAdministration then DosageInstructionsNonStructuredEntryContentModule(dosage, substanceAdministration) &quot;DosageInstructionsNonStructuredEntryContentModule&quot;;
  // TODO: Contains 2.16.756.5.30.1.1.10.4.37 Dosage Intake Mode Entry Content Module (DYNAMIC)
  medicationStatement.note as note -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'COMP',  entryRelationship.act as act then AnnotationComment(note, act) &quot;AnnotationComment&quot;;
  medicationStatement.extension as extension where $this.url = 'http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-ext-substitution' -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'COMP',  entryRelationship.act as act then SubstitutionStatement(extension, act) &quot;Substitution&quot;;
}

// TODO: Tapered Dose
// medicationStatement -&gt; substanceAdministration.templateId as templateId, templateId.root = '1.3.6.1.4.1.19376.1.5.3.1.4.8' &quot;taperedDose&quot;;
// source: http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured
// target: https://art-decor.org/art-decor/decor-templates--ch-pharm-?id=2.16.756.5.30.1.1.10.4.35
// dosage for normal dosing (without sequences) (Statement, Prescription)
group DosageInstructionsStartStopFrequencySubstanceAdministration(source dosage : Dosage, target substanceAdministration : SubstanceAdministration) {
  dosage -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.5.3.1.4.7.1' &quot;normalDose&quot;;
  dosage as dosage -&gt; substanceAdministration as substanceAdministration then EffectiveTimeStartEnd(dosage, substanceAdministration) &quot;effectiveTimeStartEnd&quot;;
  dosage as dosage -&gt; substanceAdministration as substanceAdministration then EffectiveTimeWhenNormal(dosage, substanceAdministration) &quot;effectiveTimeWhen&quot;;
  dosage.route as route -&gt; substanceAdministration.routeCode as routeCode then CodeableConceptCE(route, routeCode);
  dosage as dosage -&gt; substanceAdministration as substanceAdministration then DoseQuantity(dosage, substanceAdministration) &quot;doseQuantity&quot;;
}

// source: http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured
// target: https://art-decor.org/art-decor/decor-templates--ch-pharm-?id=2.16.756.5.30.1.1.10.4.36
// dosage for split dosing: effectiveTime (start/stop) &amp; routeCode (Statement, Prescription)
group DosageInstructionsEntryStartStopRoute(source dosage : Dosage, target substanceAdministration : substanceAdministration, target entry : entryRelationship) {
  // if the FHIR document has a dosage templateId -&gt; take over the templateId
  dosage.extension as extension where $this.url = 'http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-ext-dosagetype' then {
    extension.valueIdentifier as valueIdentifier then {
      valueIdentifier.value as value -&gt;  substanceAdministration.templateId as templateId,  templateId.root = value &quot;templateId&quot;;
    };
  };
  // if the FHIR doucment has no dosage templateId -&gt; create templateId for split dose
  dosage as dosage where $this.extension.where(url = 'http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-ext-dosagetype').exists() = false then {
    dosage -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.5.3.1.4.9' &quot;splitDose&quot;;
  } &quot;noExtension&quot;;
  dosage as dosage -&gt; substanceAdministration as substanceAdministration then EffectiveTimeStartEnd(dosage, substanceAdministration) &quot;effectiveTimeStartEnd&quot;;
  dosage.route as route -&gt; substanceAdministration.routeCode as routeCode then CodeableConceptCE(route, routeCode);
}

// source: http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured
// target: https://art-decor.org/art-decor/decor-templates--ch-pharm-?id=2.16.756.5.30.1.1.10.4.36
// dosage for split dosing: sequence number, effectiveTime (when), dose quantity, consumable (Statement, Prescription)
group DosageInstructionsEntryDosageChangeSubstanceAdministration(source dosage : Dosage, target substanceAdministration : substanceAdministration, target entry : entryRelationship) {
  dosage.sequence as sequence -&gt;  entry.sequenceNumber as sequenceNumber,  sequenceNumber.value = sequence;
  dosage -&gt;  entry.substanceAdministration as substanceAdministration,  substanceAdministration.classCode = 'SBADM',  substanceAdministration.moodCode = 'INT' then {
    dosage as dosage -&gt; substanceAdministration as substanceAdministration then EffectiveTimeWhenSplit(dosage, substanceAdministration) &quot;effectiveTimeWhen&quot;;
    dosage as dosage -&gt; substanceAdministration as substanceAdministration then DoseQuantity(dosage, substanceAdministration) &quot;doseQuantity&quot;;
    dosage as dosage -&gt;  substanceAdministration as substanceAdministration,  substanceAdministration.consumable as consumable,  consumable.manufacturedProduct as manufacturedProduct,  manufacturedProduct.manufacturedMaterial as manufacturedMaterial,  manufacturedMaterial.nullFlavor = 'NA' &quot;consumable&quot;;
  } &quot;dosage&quot;;
}

// effective time low and high for dosage (Statement, Prescription)
group EffectiveTimeStartEnd(source dosage : Dosage, target substanceAdministration : SubstanceAdministration) {
  dosage.timing as timing then {
    timing.repeat as repeat then {
      repeat.bounds : Period as bounds -&gt; substanceAdministration.effectiveTime = create('IVL_TS') as effectiveTime then {
        bounds.start as start -&gt; effectiveTime.low as low then DateTS(start, low) &quot;low&quot;;
        bounds.end as end -&gt; effectiveTime.high as high then DateTS(end, high) &quot;high&quot;;
      };
    };
  };
}

// dose quantity for dosage (application schema) (Statement)
group DoseQuantity(source dosage : Dosage, target substanceAdministration : SubstanceAdministration) {
  dosage.doseAndRate as doseAndRate -&gt; substanceAdministration.doseQuantity as doseQuantity then {
    doseAndRate.dose : Quantity as quantity then {
      quantity.value as value -&gt;  doseQuantity.center as center,  center.value = value;
    } &quot;quantity&quot;;
  } &quot;doseQuantity&quot;;
}

// source: reasonCode Coding (e.g. http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-medicationstatement)
// target: https://art-decor.org/art-decor/decor-templates--cdachemed-?section=templates&amp;id=2.16.756.5.30.1.1.10.4.41
// Treatment Reason (Statement, Prescription)
// Note/Warning: we assume that there is a narrativeLink extension which refers to the text which should be the same as in reasonCode.text
group TreatmentReasonEntryContentModule(source reasonCode : Coding, target observation : Observation) {
  reasonCode -&gt; observation.classCode = 'OBS' &quot;OBS&quot;;
  reasonCode -&gt; observation.moodCode = 'EVN' &quot;EVN&quot;;
  reasonCode -&gt;  observation.templateId as templateId,  templateId.root = '2.16.756.5.30.1.1.10.4.41' &quot;TreatmentReasonEntryContentModule&quot;;
  reasonCode -&gt;  observation.code as code,  code.code = '75326-9',  code.codeSystem = '2.16.840.1.113883.6.1',  code.displayName = 'Problem',  code.codeSystemName = 'LOINC' &quot;code&quot;;
  reasonCode.extension as extension where $this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink' then {
    extension.valueUrl as valueUrl -&gt;  observation.text as text,  text.reference as reference,  reference.value = valueUrl &quot;reference&quot;;
  } &quot;id&quot;;
  reasonCode -&gt;  observation.statusCode as code,  code.code = 'completed' &quot;statusCode&quot;;
}

// source: http://build.fhir.org/ig/hl7ch/ch-emed/branches/master/StructureDefinition-ch-emed-ext-treatmentplan.html
// target: https://art-decor.org/art-decor/decor-templates--ch-pharm-?section=templates&amp;id=2.16.756.5.30.1.1.10.4.45&amp;effectiveDate=2017-01-10T15:34:25&amp;language=en-US
group MTPReferenceEntryContentModule(source ext : Extension, target substanceAdministration : SubstanceAdministration) {
  ext -&gt; substanceAdministration.classCode = 'SBADM' &quot;SBADM&quot;;
  ext -&gt; substanceAdministration.moodCode = 'INT' &quot;INT&quot;;
  ext -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.10' &quot;referenceTo-MTP-PlanItemGeneralSpecificationTemplateId&quot;;
  ext -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '2.16.756.5.30.1.1.10.4.45' &quot;CH-PHARM-templateId&quot;;
  ext.extension as extension where $this.url = 'id' then {
    extension.valueIdentifier as valueIdentifier -&gt; substanceAdministration.id as id then IdentifierII(valueIdentifier, id) &quot;id&quot;;
  } &quot;id&quot;;
  ext -&gt;  substanceAdministration.code as code,  code.code = 'MTPItem',  code.codeSystem = '1.3.6.1.4.1.19376.1.9.2.2',  code.displayName = 'Medication Treatment Plan Item',  code.codeSystemName = 'IHE Pharmacy Item Type List' &quot;code&quot;;
  ext -&gt;  substanceAdministration.consumable as consumable,  consumable.manufacturedProduct as manufacturedProduct,  manufacturedProduct.manufacturedMaterial as manufacturedMaterial,  manufacturedMaterial.nullFlavor = 'NA' &quot;consumable&quot;;
  ext.extension as extension where $this.url = 'externalDocumentId' then {
    extension.valueIdentifier as valueIdentifier -&gt;  substanceAdministration.reference as reference,  reference.typeCode = 'XCRPT',  reference.externalDocument as externalDocument,  externalDocument.id as id then IdentifierII(valueIdentifier, id) &quot;id&quot;;
  } &quot;externalDocumentId&quot;;
}

// source: http://build.fhir.org/ig/hl7ch/ch-emed/branches/master/StructureDefinition-ch-emed-dosage-nonstructured.html
// target: https://art-decor.org/art-decor/decor-templates--ch-pharm-?section=templates&amp;id=2.16.756.5.30.1.1.10.4.52
// target: https://art-decor.org/art-decor/decor-templates--ch-pharm-?section=templates&amp;id=2.16.756.5.30.1.1.10.4.37
// Dosage Instruction (Statement, Prescription)
// Note/Warning: we assume that there is a narrativeLink extension which refers to the text which should be the same as in note.text
group DosageInstructionsNonStructuredEntryContentModule(source dosage : Dosage, target substanceAdministration : SubstanceAdministration) {
  dosage -&gt; substanceAdministration.classCode = 'SBADM' &quot;SBADM&quot;;
  dosage -&gt; substanceAdministration.moodCode = 'INT' &quot;INT&quot;;
  dosage -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '2.16.756.5.30.1.1.10.4.37' &quot;templateId&quot;;
  dosage.extension as extension where $this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink' then {
    extension.valueUrl as valueUrl -&gt;  substanceAdministration.text as text,  text.reference as reference,  reference.value = valueUrl &quot;reference&quot;;
  } &quot;id&quot;;
  dosage -&gt;  substanceAdministration.consumable as consumable,  consumable.manufacturedProduct as manufacturedProduct,  manufacturedProduct.manufacturedMaterial as manufacturedMaterial,  manufacturedMaterial.nullFlavor = 'NA' &quot;consumable&quot;;
}

// source: http://build.fhir.org/ig/hl7ch/ch-emed/branches/master/StructureDefinition-ch-emed-medicationdispense.html
// target: Substitution act Contains 1.3.6.1.4.1.19376.1.9.1.3.9.2 IHE Substitution Act Content Module
// Substitution (Dispense)
group SubstitutionDispense(source substitution : Substitution, target act : Act) {
  substitution -&gt; act.classCode = 'ACT' &quot;ACT&quot;;
  substitution -&gt; act.moodCode = 'EVN' &quot;EVN&quot;;
  substitution -&gt;  act.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.9.2' &quot;templateId&quot;;
  substitution.type as type -&gt; act.code as code then CodeableConceptCE(type, code) &quot;substitution&quot;;
  substitution -&gt;  act.statusCode as statusCode,  statusCode.code = 'completed' &quot;statusCode&quot;;
}

// source: http://build.fhir.org/ig/hl7ch/ch-emed/branches/master/StructureDefinition-ch-emed-medicationdispense.html
// target: https://art-decor.org/art-decor/decor-templates--cdachemed-?section=templates&amp;id=2.16.756.5.30.1.1.10.4.33&amp;effectiveDate=2019-12-11T11:34:24&amp;language=en-US
group ManufacturedMaterialEntryContentModuleDispense(source bundle : Bundle, source medicationDispense : MedicationDispense, source medication : Medication, target manufacturedMaterial : ManufacturedMaterial) {
  medication -&gt; manufacturedMaterial.classCode = 'MMAT' &quot;MMAT&quot;;
  medication -&gt; manufacturedMaterial.determinerCode = 'KIND' &quot;KIND&quot;;
  medication -&gt;  manufacturedMaterial.templateId as templateId,  templateId.root = '2.16.756.5.30.1.1.10.4.33' &quot;CH-PHARM-ManufacturedMaterialContentModule&quot;;
  medication -&gt;  manufacturedMaterial.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.1' &quot;templateId&quot;;
  medication.code as code then {
    code.text as text -&gt;  manufacturedMaterial.name as name,  name.other = text &quot;brandname&quot;;
  } &quot;name&quot;;
  medication.code as code then {
    // #dis.no.brandedmedication
    code.extension as extension where $this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink' -&gt; manufacturedMaterial.code as code then {
      extension.valueUrl as valueUrl -&gt;  code.originalText as text,  text.reference as reference,  reference.value = valueUrl &quot;reference&quot;;
    } &quot;id&quot;;
    code.coding as coding -&gt; manufacturedMaterial.code as ce then CodingCE(coding, ce) &quot;code&quot;;
  };
  medication.form as form then {
    form.coding as coding -&gt; manufacturedMaterial.formCode as formCode then CodingCE(coding, formCode) &quot;formCode&quot;;
  };
  medication.code as code -&gt;  manufacturedMaterial.asContent as asContent,  asContent.classCode = 'CONT',  asContent.containerPackagedMedicine as containerPackagedMedicine then {
    code -&gt; containerPackagedMedicine.classCode = 'CONT' &quot;CONT&quot;;
    code -&gt; containerPackagedMedicine.determinerCode = 'INSTANCE' &quot;INSTANCE&quot;;
    code.coding as coding -&gt; containerPackagedMedicine.code as ce then CodingCE(coding, ce) &quot;pharm-code&quot;;
    code.text as text -&gt;  containerPackagedMedicine.name as name,  name.other = text &quot;pharm-name&quot;;
    medication.form as form then {
      form.coding as coding -&gt; containerPackagedMedicine.formCode as formCode then CodingCE(coding, formCode) &quot;pharm-formCode&quot;;
    };
    // package size
    medication.amount as amount then {
      amount.numerator as numerator then {
        // if the value of numerator.code is &quot;1&quot;, then it is not a UCUM code, so generate case 1
        numerator.code as code where $this = '1' -&gt; containerPackagedMedicine.capacityQuantity as capacityQuantity then {
          numerator.value as value -&gt; capacityQuantity.value = value;
        } &quot;noUcum&quot;;
        // if the value of numerator.code is not &quot;1&quot;, then it is a UCUM code, so generate case 2
        numerator.code as code where $this != '1' -&gt; containerPackagedMedicine.capacityQuantity as capacityQuantity then {
          numerator.value as value -&gt; capacityQuantity.value = value;
          numerator.unit as unit -&gt; capacityQuantity.unit = unit;
        } &quot;ucum&quot;;
        // if there ist no numerator.code, case 1 is generated, because no unit exists
        numerator as numerator where $this.code.exists() = false -&gt; containerPackagedMedicine.capacityQuantity as capacityQuantity then {
          numerator.value as value -&gt; capacityQuantity.value = value;
        } &quot;noUcum&quot;;
      };
    };
  };
  medication.ingredient as ingredient -&gt;  manufacturedMaterial.ingredient as ingredient,  ingredient.classCode = 'ACTI' then {
    ingredient.itemCodeableConcept as itemCodeableConcept -&gt; ingredient.ingredient as pharmsubstance then {
      itemCodeableConcept -&gt; pharmsubstance.classCode = 'MMAT' &quot;MMAT&quot;;
      itemCodeableConcept -&gt; pharmsubstance.determinerCode = 'KIND' &quot;KIND&quot;;
      itemCodeableConcept.text as text -&gt;  pharmsubstance.name as name,  name.other = text &quot;name&quot;;
      itemCodeableConcept.coding as coding then {
        coding -&gt; pharmsubstance.code as ce then CodingCE(coding, ce) &quot;formCode&quot;;
      };
    } &quot;PharmSubstance&quot;;
    ingredient.strength as strength -&gt; ingredient.quantity as quantity then RatioRTOPQPQ(strength, quantity);
  };
}

// source: http://build.fhir.org/ig/hl7ch/ch-emed/branches/master/StructureDefinition-ch-emed-medicationdispense.html
// target: https://art-decor.org/art-decor/decor-templates--cdachemed-?section=templates&amp;id=2.16.756.5.30.1.1.10.4.42
group DispenseItemEntryContentModule(source bundle : Bundle, source medicationDispense : MedicationDispense, target supply : Supply) {
  medicationDispense -&gt; supply.classCode = 'SPLY' &quot;SPLY&quot;;
  medicationDispense -&gt; supply.moodCode = 'EVN' &quot;EVN&quot;;
  medicationDispense -&gt;  supply.templateId as templateId,  templateId.root = '2.16.756.5.30.1.1.10.4.42' &quot;CH-PHARM-DispenseItemEntryContentModule&quot;;
  medicationDispense -&gt;  supply.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.4' &quot;IHE-PHARM-DIS&quot;;
  medicationDispense -&gt;  supply.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.5.3.1.4.7.3' &quot;supplyEntry&quot;;
  medicationDispense -&gt;  supply.templateId as templateId,  templateId.root = '2.16.840.1.113883.10.20.1.34' &quot;CCD&quot;;
  medicationDispense.identifier as identifier -&gt; supply.id as id then IdentifierII(identifier, id) &quot;id&quot;;
  medicationDispense.extension as extension where $this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink' -&gt;  supply.text as text,  text.reference as reference then {
    extension.valueUrl as valueUrl -&gt; reference.value = valueUrl;
  } &quot;narrativeLink&quot;;
  medicationDispense.contained as medication where ('#' + $this.id) in %medicationDispense.medicationReference.reference -&gt;  supply.product as product,  product.manufacturedProduct as manufacturedProduct,  manufacturedProduct.classCode = 'MANU' then {
    medication -&gt;  manufacturedProduct.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.5.3.1.4.7.2' &quot;MP-TemplateId&quot;;
    medication -&gt;  manufacturedProduct.templateId as templateId,  templateId.root = '2.16.840.1.113883.10.20.1.53' &quot;MP-TemplateId&quot;;
    medication -&gt; manufacturedProduct.manufacturedMaterial as manufacturedMaterial then ManufacturedMaterialEntryContentModuleDispense(bundle, medicationDispense, medication, manufacturedMaterial) &quot;manufacturedMaterial&quot;;
  };
  // TODO: AUTHOR1 Medication Treatment Plan Author
  medicationDispense.dosageInstruction as dosage where $this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured') and $this.sequence.empty() then DosageInstructionsStartStopFrequencySupply(dosage, supply) &quot;DosageSubstanceAdministration&quot;;
  // dosage for split dosing, as sequences are present there
  medicationDispense -&gt; supply.entryRelationship as entryRelationship then {
    medicationDispense -&gt; entryRelationship.substanceAdministration as substanceAdministration then {
      // split dosing (with sequences): effectiveTime (start/stop) &amp; routeCode &amp; consumable
      medicationDispense.dosageInstruction first as dosage where $this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured') and $this.sequence.exists() -&gt; substanceAdministration then DosageInstructionsEntryStartStopRouteConsumable(dosage, entryRelationship, substanceAdministration) &quot;DosageSubstanceAdministration&quot;;
      // split dosing (with sequences): sequence number, effectiveTime (when), dose quantity, consumable
      medicationDispense.dosageInstruction as dosage where $this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured') and $this.sequence.exists() -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'COMP' then DosageInstructionsEntryDosageChangeEntryRelationship(dosage, entryRelationship) &quot;DosageSubstanceAdministration&quot;;
    } &quot;substanceAdministration&quot;;
  } &quot;entryRelationship&quot;;
  medicationDispense.extension as extension where url = 'http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-ext-treatmentplan' -&gt;  supply.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'REFR',  entryRelationship.substanceAdministration as substanceAdministration then MTPReferenceEntryContentModule(extension, substanceAdministration) &quot;MTP-Reference&quot;;
  // TODO: Patient Medication Instructions Contains 1.3.6.1.4.1.19376.1.5.3.1.4.3 IHE Patient Medication Instructions (DYNAMIC)
  medicationDispense.dosageInstruction as dosage where $this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-nonstructured') -&gt;  supply.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'COMP',  entryRelationship.substanceAdministration as substanceAdministration then DosageInstructionsNonStructuredEntryContentModule(dosage, substanceAdministration) &quot;DosageInstructionsNonStructuredEntryContentModule&quot;;
  // TODO: Contains 2.16.756.5.30.1.1.10.4.37 Dosage Intake Mode Entry Content Module (DYNAMIC)
  medicationDispense.quantity as quantity -&gt; supply.quantity as supplyQuantity then {
    quantity.value as value -&gt; supplyQuantity.value = value;
  };
  medicationDispense.note as note -&gt;  supply.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'COMP',  entryRelationship.act as act then AnnotationComment(note, act) &quot;AnnotationComment&quot;;
  medicationDispense.substitution as substitution -&gt;  supply.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'COMP',  entryRelationship.act as act then SubstitutionDispense(substitution, act) &quot;Substitution&quot;;
}

// source: http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured
// target: https://art-decor.org/art-decor/decor-templates--ch-pharm-?id=2.16.756.5.30.1.1.10.4.35
// dosage for normal dosing (without sequences) (Dispense)
group DosageInstructionsStartStopFrequencySupply(source dosage : Dosage, target supply : Supply) {
  dosage -&gt; supply.entryRelationship as entryRelationship then {
    dosage -&gt; entryRelationship.typeCode = 'COMP' &quot;COMP&quot;;
    dosage -&gt; entryRelationship.substanceAdministration as substanceAdministration then {
      dosage -&gt; substanceAdministration.classCode = 'SBADM' &quot;SBADM&quot;;
      dosage -&gt; substanceAdministration.moodCode = 'INT' &quot;INT&quot;;
      dosage -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.6' &quot;templateId&quot;;
      dosage -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.5.3.1.4.7.1' &quot;normalDose&quot;;
      dosage -&gt; substanceAdministration as substanceAdministration then EffectiveTimeStartEnd(dosage, substanceAdministration) &quot;effectiveTimeStartEnd&quot;;
      dosage -&gt; substanceAdministration as substanceAdministration then EffectiveTimeWhenNormal(dosage, substanceAdministration) &quot;effectiveTimeWhen&quot;;
      dosage.route as route -&gt; substanceAdministration.routeCode as routeCode then CodeableConceptCE(route, routeCode);
      dosage -&gt; substanceAdministration as substanceAdministration then DoseQuantity(dosage, substanceAdministration) &quot;doseQuantity&quot;;
      dosage -&gt;  substanceAdministration as substanceAdministration,  substanceAdministration.consumable as consumable,  consumable.manufacturedProduct as manufacturedProduct,  manufacturedProduct.manufacturedMaterial as manufacturedMaterial,  manufacturedMaterial.nullFlavor = 'NA' &quot;consumable&quot;;
    } &quot;substanceAdministration&quot;;
  } &quot;entryRelationship&quot;;
}

// source: http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured
// target: https://art-decor.org/art-decor/decor-templates--ch-pharm-?id=2.16.756.5.30.1.1.10.4.36
// dosage for split dosing: effectiveTime (start/stop) &amp; routeCode &amp; consumable (Dispense)
group DosageInstructionsEntryStartStopRouteConsumable(source dosage : Dosage, target entryRelationship : entryRelationship, target substanceAdministration : SubstanceAdministration) {
  dosage -&gt; entryRelationship.typeCode = 'COMP' &quot;COMP&quot;;
  dosage -&gt; substanceAdministration.classCode = 'SBADM' &quot;SBADM&quot;;
  dosage -&gt; substanceAdministration.moodCode = 'INT' &quot;INT&quot;;
  dosage -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.6' &quot;templateId&quot;;
  // if the FHIR document has a dosage templateId -&gt; take over the templateId
  dosage.extension as extension where $this.url = 'http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-ext-dosagetype' then {
    extension.valueIdentifier as valueIdentifier then {
      valueIdentifier.value as value -&gt;  substanceAdministration.templateId as templateId,  templateId.root = value &quot;templateId&quot;;
    };
  };
  // if the FHIR doucment has no dosage templateId -&gt; create templateId for split dose
  dosage as dosage where $this.extension.where(url = 'http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-ext-dosagetype').exists() = false then {
    dosage -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.5.3.1.4.9' &quot;splitDose&quot;;
  } &quot;noExtension&quot;;
  dosage -&gt; substanceAdministration as substanceAdministration then EffectiveTimeStartEnd(dosage, substanceAdministration) &quot;effectiveTimeStartEnd&quot;;
  dosage.route as route -&gt; substanceAdministration.routeCode as routeCode then CodeableConceptCE(route, routeCode);
  dosage -&gt;  substanceAdministration.consumable as consumable,  consumable.manufacturedProduct as manufacturedProduct,  manufacturedProduct.manufacturedMaterial as manufacturedMaterial,  manufacturedMaterial.nullFlavor = 'NA' &quot;consumable&quot;;
}

// source: http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured
// target: https://art-decor.org/art-decor/decor-templates--ch-pharm-?id=2.16.756.5.30.1.1.10.4.36
// dosage for split dosing: sequence number, effectiveTime (when), dose quantity, consumable (Dispense)
group DosageInstructionsEntryDosageChangeEntryRelationship(source dosage : Dosage, target entryRelationship : entryRelationship) {
  dosage.sequence as sequence -&gt;  entryRelationship.sequenceNumber as sequenceNumber,  sequenceNumber.value = sequence;
  dosage -&gt;  entryRelationship.substanceAdministration as substanceAdministration,  substanceAdministration.classCode = 'SBADM',  substanceAdministration.moodCode = 'INT' then {
    dosage as dosage -&gt; substanceAdministration then EffectiveTimeWhenSplit(dosage, substanceAdministration) &quot;effectiveTimeWhen&quot;;
    dosage as dosage -&gt; substanceAdministration then DoseQuantity(dosage, substanceAdministration) &quot;doseQuantity&quot;;
    dosage as dosage -&gt;  substanceAdministration.consumable as consumable,  consumable.manufacturedProduct as manufacturedProduct,  manufacturedProduct.manufacturedMaterial as manufacturedMaterial,  manufacturedMaterial.nullFlavor = 'NA' &quot;consumable&quot;;
  } &quot;dosage&quot;;
}

// effective time when for normal dosage (Dispense, Statement, Prescription)
group EffectiveTimeWhenNormal(source dosage : Dosage, target substanceAdministration : SubstanceAdministration) {
  dosage.timing as timing then {
    timing.repeat as repeat then {
      repeat where $this.when.count() = 1 -&gt;  substanceAdministration.effectiveTime = create('EIVL_TS') as effectiveTime,  effectiveTime.operator = 'A' then {
        repeat.when as when -&gt;  effectiveTime.event as event,  event.code = when;
      } &quot;when&quot;;
      repeat where $this.when.count() &gt; 1 -&gt;  substanceAdministration.effectiveTime = create('SXPR_TS') as effectiveTime,  effectiveTime.operator = 'A' then {
        repeat.when first as when -&gt; effectiveTime.comp = create('EIVL_TS') as comp then {
          when -&gt;  comp.event as event,  event.code = when &quot;when&quot;;
        } &quot;comp&quot;;
        repeat.when not_first as when -&gt;  effectiveTime.comp = create('EIVL_TS') as comp,  comp.operator = 'I' then {
          when -&gt;  comp.event as event,  event.code = when &quot;when&quot;;
        } &quot;compnotfirst&quot;;
      } &quot;when&quot;;
    };
  };
}

// effective time when for split dosage (Dispense, Statement, Prescription)
group EffectiveTimeWhenSplit(source dosage : Dosage, target substanceAdministration : SubstanceAdministration) {
  dosage.timing as timing then {
    timing.repeat as repeat then {
      repeat where $this.when.count() = 1 -&gt; substanceAdministration.effectiveTime = create('EIVL_TS') as effectiveTime then {
        repeat.when as when -&gt;  effectiveTime.event as event,  event.code = when;
      } &quot;when&quot;;
      repeat where $this.when.count() &gt; 1 -&gt;  substanceAdministration.effectiveTime = create('SXPR_TS') as effectiveTime,  effectiveTime.operator = 'A' then {
        repeat.when first as when -&gt; effectiveTime.comp = create('EIVL_TS') as comp then {
          when -&gt;  comp.event as event,  event.code = when &quot;when&quot;;
        } &quot;comp&quot;;
        repeat.when not_first as when -&gt;  effectiveTime.comp = create('EIVL_TS') as comp,  comp.operator = 'I' then {
          when -&gt;  comp.event as event,  event.code = when &quot;when&quot;;
        } &quot;compnotfirst&quot;;
      } &quot;when&quot;;
    };
  };
}

// source: http://build.fhir.org/ig/hl7ch/ch-emed/branches/master/StructureDefinition-ch-emed-medicationrequest.html
// target: Substitution permission Contains 1.3.6.1.4.1.19376.1.9.1.3.9.1 IHE Substitution Permission Content Module
group SubstitutionRequest(source substitution : Substitution, target act : Act) {
  substitution -&gt; act.classCode = 'ACT' &quot;ACT&quot;;
  substitution -&gt; act.moodCode = 'DEF' &quot;DEF&quot;;
  substitution -&gt;  act.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.9.1' &quot;templateId&quot;;
  substitution.allowedCodeableConcept as allowedCC -&gt; act.code as code then CodeableConceptCE(allowedCC, code) &quot;substitution&quot;;
  substitution -&gt;  act.statusCode as statusCode,  statusCode.code = 'completed' &quot;statusCode&quot;;
}

// source: http://build.fhir.org/ig/hl7ch/ch-emed/branches/master/StructureDefinition-ch-emed-medicationrequest.html
// target: Substitution permission Contains 1.3.6.1.4.1.19376.1.9.1.3.9.1 IHE Substitution Permission Content Module
group SubstitutionStatement(source extension : Extension, target act : Act) {
  extension -&gt; act.classCode = 'ACT' &quot;ACT&quot;;
  extension -&gt; act.moodCode = 'DEF' &quot;DEF&quot;;
  extension -&gt;  act.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.9.1' &quot;templateId&quot;;
  extension.valueCodeableConcept as valueCC -&gt; act.code as code then CodeableConceptCE(valueCC, code) &quot;extension&quot;;
  extension -&gt;  act.statusCode as statusCode,  statusCode.code = 'completed' &quot;statusCode&quot;;
}

// source: http://build.fhir.org/ig/hl7ch/ch-emed/branches/master/StructureDefinition-ch-emed-medicationrequest.html
// target: https://art-decor.org/art-decor/decor-templates--cdachemed-?id=2.16.756.5.30.1.1.10.4.38
group PrescribedQuantity(source dispenseRequest : DispenseRequest, target supply : Supply) {
  dispenseRequest -&gt; supply.classCode = 'SPLY' &quot;SPLY&quot;;
  dispenseRequest -&gt; supply.moodCode = 'RQO' &quot;RQO&quot;;
  dispenseRequest -&gt;  supply.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.8' &quot;templateId&quot;;
  dispenseRequest -&gt;  supply.independentInd as independentInd,  independentInd.value = 'false' &quot;independentInd&quot;;
  // Number of packages
  dispenseRequest.quantity as quantity -&gt; supply.quantity as quant then {
    quantity.value as value -&gt; quant.value = value;
  };
}

// source: http://build.fhir.org/ig/hl7ch/ch-emed/branches/master/StructureDefinition-ch-emed-medicationrequest.html
// target: https://art-decor.org/art-decor/decor-templates--cdachemed-?id=2.16.756.5.30.1.1.10.4.38
group PrescribedQuantityUnit(source dispenseRequest : DispenseRequest, target supply : Supply) {
  dispenseRequest -&gt; supply.classCode = 'SPLY' &quot;SPLY&quot;;
  dispenseRequest -&gt; supply.moodCode = 'RQO' &quot;RQO&quot;;
  dispenseRequest -&gt;  supply.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.8' &quot;TemplateId&quot;;
  dispenseRequest -&gt;  supply.independentInd as independentInd,  independentInd.value = 'false' &quot;independentInd&quot;;
  // Number of packages
  dispenseRequest.quantity as quantity -&gt; supply.quantity as quant then {
    quantity.value as value -&gt; quant.value = value;
    quantity.unit as unit -&gt; quant.unit = unit;
  };
}

// source: http://build.fhir.org/ig/hl7ch/ch-emed/branches/master/StructureDefinition-ch-emed-medicationrequest.html
// target: https://art-decor.org/art-decor/decor-templates--cdachemed-?section=templates&amp;id=2.16.756.5.30.1.1.10.4.33
group ManufacturedMaterialEntryContentModulePrescription(source bundle : Bundle, source medicationRequest : MedicationRequest, source medication : Medication, target manufacturedMaterial : ManufacturedMaterial, target substanceAdministration : SubstanceAdministration) {
  medication -&gt; manufacturedMaterial.classCode = 'MMAT' &quot;MMAT&quot;;
  medication -&gt; manufacturedMaterial.determinerCode = 'KIND' &quot;KIND&quot;;
  medication -&gt;  manufacturedMaterial.templateId as templateId,  templateId.root = '2.16.756.5.30.1.1.10.4.33' &quot;CH-PHARM-ManufacturedMaterialContentModule&quot;;
  medication -&gt;  manufacturedMaterial.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.1' &quot;templateId&quot;;
  medication.code as code then {
    code.text as text -&gt;  manufacturedMaterial.name as name,  name.other = text &quot;brandname&quot;;
  } &quot;name&quot;;
  medication.code as code then {
    // #pre.no.brandedmedication
    code.extension as extension where $this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink' -&gt; manufacturedMaterial.code as code then {
      extension.valueUrl as valueUrl -&gt;  code.originalText as text,  text.reference as reference,  reference.value = valueUrl &quot;reference&quot;;
    } &quot;id&quot;;
    code.coding as coding -&gt; manufacturedMaterial.code as ce then CodingCE(coding, ce) &quot;code&quot;;
  };
  medication.form as form then {
    form.coding as coding -&gt; manufacturedMaterial.formCode as formCode then CodingCE(coding, formCode) &quot;formCode&quot;;
  };
  medication.code as code -&gt;  manufacturedMaterial.asContent as asContent,  asContent.classCode = 'CONT',  asContent.containerPackagedMedicine as containerPackagedMedicine then {
    code -&gt; containerPackagedMedicine.classCode = 'CONT' &quot;CONT&quot;;
    code -&gt; containerPackagedMedicine.determinerCode = 'INSTANCE' &quot;INSTANCE&quot;;
    code.coding as coding -&gt; containerPackagedMedicine.code as ce then CodingCE(coding, ce) &quot;pharm-code&quot;;
    code.text as text -&gt;  containerPackagedMedicine.name as name,  name.other = text &quot;pharm-name&quot;;
    medication.form as form then {
      form.coding as coding -&gt; containerPackagedMedicine.formCode as formCode then CodingCE(coding, formCode) &quot;pharm-formCode&quot;;
    };
    // Package size
    medication.amount as amount then {
      amount.numerator as numerator then {
        // if the value of numerator.code is &quot;1&quot;, then it is not a UCUM code, so generate case 1
        numerator.code as code where $this = '1' -&gt; containerPackagedMedicine.capacityQuantity as capacityQuantity then {
          numerator.value as value -&gt; capacityQuantity.value = value;
        } &quot;noUcum&quot;;
        // if the value of numerator.code is not &quot;1&quot;, then it is a UCUM code, so generate case 2
        numerator.code as code where $this != '1' -&gt; containerPackagedMedicine.capacityQuantity as capacityQuantity then {
          numerator.value as value -&gt; capacityQuantity.value = value;
          numerator.unit as unit -&gt; capacityQuantity.unit = unit;
        } &quot;ucum&quot;;
        // if there ist no numerator.code, case 1 is generated, because no unit exists
        numerator as numerator where $this.code.exists() = false -&gt; containerPackagedMedicine.capacityQuantity as capacityQuantity then {
          numerator.value as value -&gt; capacityQuantity.value = value;
        } &quot;noUcum&quot;;
      };
      // IHE-DIS: Case 1: If the product-element contains package information, the unit attribute is not be present
      medicationRequest.dispenseRequest as dispenseRequest -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'COMP',  entryRelationship.supply as supply then PrescribedQuantity(dispenseRequest, supply) &quot;PrescribedQuantity&quot;;
    };
    // IHE-DIS: Case 2: If the product-element does not contain package information, the unit attribut is present and the value SHALL be out of the UCUM code system
    medication where $this.amount.exists() = false then {
      medicationRequest.dispenseRequest as dispenseRequest -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'COMP',  entryRelationship.supply as supply then PrescribedQuantityUnit(dispenseRequest, supply) &quot;PrescribedQuantityUnit&quot;;
    } &quot;noAmount&quot;;
  };
  medication.ingredient as ingredient -&gt;  manufacturedMaterial.ingredient as ingredient,  ingredient.classCode = 'ACTI' then {
    ingredient.itemCodeableConcept as itemCodeableConcept -&gt; ingredient.ingredient as pharmsubstance then {
      itemCodeableConcept -&gt; pharmsubstance.classCode = 'MMAT' &quot;MMAT&quot;;
      itemCodeableConcept -&gt; pharmsubstance.determinerCode = 'KIND' &quot;KIND&quot;;
      itemCodeableConcept.text as text -&gt;  pharmsubstance.name as name,  name.other = text &quot;name&quot;;
      itemCodeableConcept.coding as coding then {
        coding -&gt; pharmsubstance.code as ce then CodingCE(coding, ce) &quot;formCode&quot;;
      };
    } &quot;PharmSubstance&quot;;
    ingredient.strength as strength -&gt; ingredient.quantity as quantity then RatioRTOPQPQ(strength, quantity);
  };
}

// source: http://build.fhir.org/ig/hl7ch/ch-emed/branches/master/StructureDefinition-ch-emed-medicationrequest.html
// target: https://art-decor.org/art-decor/decor-templates--cdachemed-?section=templates&amp;id=2.16.756.5.30.1.1.10.4.43
group PrescriptionItemEntryContentModule(source bundle : Bundle, source medicationRequest : MedicationRequest, target substanceAdministration : SubstanceAdministration) {
  medicationRequest -&gt; substanceAdministration.classCode = 'SBADM' &quot;SBADM&quot;;
  medicationRequest -&gt; substanceAdministration.moodCode = 'INT' &quot;INT&quot;;
  medicationRequest -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '2.16.756.5.30.1.1.10.4.43' &quot;CH-PHARM-PrescriptionItemEntryContentModule&quot;;
  medicationRequest -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.2' &quot;PrescriptionItemEntryTemplateId&quot;;
  medicationRequest -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '2.16.840.1.113883.10.20.1.24' &quot;CCD&quot;;
  medicationRequest -&gt;  substanceAdministration.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.5.3.1.4.7' &quot;PCC-MedicationEntryContentModule&quot;;
  medicationRequest.identifier as identifier -&gt; substanceAdministration.id as id then IdentifierII(identifier, id) &quot;id&quot;;
  medicationRequest.extension as extension where $this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink' -&gt;  substanceAdministration.text as text,  text.reference as reference then {
    extension.valueUrl as valueUrl -&gt; reference.value = valueUrl;
  } &quot;narrativeLink&quot;;
  medicationRequest -&gt;  substanceAdministration.statusCode as statusCode,  statusCode.code = 'completed' &quot;code&quot;;
  medicationRequest.dispenseRequest as dispenseRequest -&gt; substanceAdministration.repeatNumber as repeatNumber then {
    dispenseRequest.numberOfRepeatsAllowed as number -&gt; repeatNumber.value = number &quot;repeatNumber&quot;;
  };
  medicationRequest.contained as medication where ('#' + $this.id) in %medicationRequest.medicationReference.reference -&gt;  substanceAdministration.consumable as consumable,  consumable.manufacturedProduct as manufacturedProduct,  manufacturedProduct.classCode = 'MANU' then {
    medication -&gt;  manufacturedProduct.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.5.3.1.4.7.2' &quot;MP-templateId&quot;;
    medication -&gt;  manufacturedProduct.templateId as templateId,  templateId.root = '2.16.840.1.113883.10.20.1.53' &quot;MP-templateId&quot;;
    medication -&gt; manufacturedProduct.manufacturedMaterial as manufacturedMaterial then ManufacturedMaterialEntryContentModulePrescription(bundle, medicationRequest, medication, manufacturedMaterial, substanceAdministration) &quot;manufacturedMaterial&quot;;
  };
  // TODO: AUTHOR1 Medication Treatment Plan Author
  medicationRequest.dosageInstruction as dosage where $this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured-medicationrequest') and $this.sequence.empty() then DosageInstructionsStartStopFrequencySubstanceAdministration(dosage, substanceAdministration) &quot;DosageSubstanceAdministration&quot;;
  // dosage for split dosing (with sequences): effectiveTime (start/stop) &amp; routeCode
  medicationRequest.dosageInstruction first as dosage where $this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured-medicationrequest') and $this.sequence.exists() -&gt; substanceAdministration.entryRelationship as entryRelationship then DosageInstructionsEntryStartStopRoute(dosage, substanceAdministration, entryRelationship) &quot;DosageSubstanceAdministration&quot;;
  // dosage for split dosing (with sequences): sequence number, effectiveTime (when), dose quantity, consumable
  medicationRequest.dosageInstruction as dosage where $this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured-medicationrequest') and $this.sequence.exists() -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'COMP' then DosageInstructionsEntryDosageChangeSubstanceAdministration(dosage, substanceAdministration, entryRelationship) &quot;DosageSubstanceAdministration&quot;;
  medicationRequest.reasonCode as reasonCode -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'RSON',  entryRelationship.observation as observation then TreatmentReasonEntryContentModule(reasonCode, observation) &quot;TreatmentReasonEntryContentModule&quot;;
  medicationRequest.extension as extension where url = 'http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-ext-treatmentplan' -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'REFR',  entryRelationship.substanceAdministration as substanceAdministration then MTPReferenceEntryContentModule(extension, substanceAdministration) &quot;MTP-Reference&quot;;
  // TODO: Patient Medication Instructions Contains 1.3.6.1.4.1.19376.1.5.3.1.4.3 IHE Patient Medication Instructions (DYNAMIC)
  medicationRequest.dosageInstruction as dosage where $this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-nonstructured') -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'COMP',  entryRelationship.substanceAdministration as substanceAdministration then DosageInstructionsNonStructuredEntryContentModule(dosage, substanceAdministration) &quot;DosageInstructionsNonStructuredEntryContentModule&quot;;
  // TODO: Contains 2.16.756.5.30.1.1.10.4.37 Dosage Intake Mode Entry Content Module (DYNAMIC)
  medicationRequest.note as note -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'COMP',  entryRelationship.act as act then AnnotationComment(note, act) &quot;AnnotationComment&quot;;
  medicationRequest.substitution as substitution -&gt;  substanceAdministration.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'COMP',  entryRelationship.act as act then SubstitutionRequest(substitution, act) &quot;Substitution&quot;;
}

// source: http://build.fhir.org/ig/hl7ch/ch-emed/StructureDefinition-ch-emed-observation.html
// target: https://art-decor.org/art-decor/decor-templates--cdachemed-?section=templates&amp;id=2.16.756.5.30.1.1.10.4.44
// Note/Warning: we assume that there is a narrativeLink extension which refers to the text which should be the same as in note.text
group PharmaceuticalAdviceItemEntryContentModule(source bundle : Bundle, source fhirobservation : Observation, target cdaobservation : Observation) {
  fhirobservation -&gt; cdaobservation.classCode = 'OBS' &quot;OBS&quot;;
  fhirobservation -&gt; cdaobservation.moodCode = 'EVN' &quot;EVN&quot;;
  fhirobservation -&gt;  cdaobservation.templateId as templateId,  templateId.root = '1.3.6.1.4.1.19376.1.9.1.3.3' &quot;IHE-PHARM-PADV&quot;;
  fhirobservation -&gt;  cdaobservation.templateId as templateId,  templateId.root = '2.16.756.5.30.1.1.10.4.44' &quot;CH-PHARM-PharmaceuticalAdviceItemEntryContentModule&quot;;
  fhirobservation.identifier as identifier -&gt; cdaobservation.id as id then IdentifierII(identifier, id) &quot;id&quot;;
  fhirobservation.code as fhirCode -&gt; cdaobservation.code as cdaCode then CodeableConceptCE(fhirCode, cdaCode);
  fhirobservation -&gt;  cdaobservation.statusCode as statusCode,  statusCode.code = 'completed' &quot;code&quot;;
  fhirobservation.effectiveDateTime as effectiveDateTime -&gt; cdaobservation.effectiveTime as effectiveTime then {
    effectiveDateTime -&gt; effectiveTime.value = effectiveDateTime &quot;value&quot;;
  } &quot;effectiveTime&quot;;
  fhirobservation.extension as extension where url = 'http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-ext-treatmentplan' -&gt;  cdaobservation.entryRelationship as entryRelationship,  entryRelationship.typeCode = 'REFR',  entryRelationship.substanceAdministration as substanceAdministration then MTPReferenceEntryContentModule(extension, substanceAdministration) &quot;MTP-Reference&quot;;
  fhirobservation.note as note then {
    note.extension as extension where $this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink' -&gt;  cdaobservation.text as text,  text.reference as reference then {
      extension.valueUrl as valueUrl -&gt; reference.value = valueUrl;
    } &quot;narrativeLink&quot;;
  };
}

</pre>
      </div>

  
  
</div>
        </div>  <!-- /inner-wrapper -->
      </div>  <!-- /row -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-content -->


  <div id="segment-footer" igtool="footer" class="segment">  <!-- segment-footer -->
    <div class="container">  <!-- container -->
      <div class="inner-wrapper">
        <p>
          IG &#169; 2020+ <a style="color: #81BEF7" href="http://www.ahdis.ch/">ahdis</a>.  Package ch.fhir.ig.cda-fhir-maps#0.1.0 based on <a style="color: #81BEF7" href="http://hl7.org/fhir/R4/">FHIR 4.0.1</a>. Generated <span title="Wed, Dec 9, 2020 15:16+0100">2020-12-09</span>
          <br/>
          <span style="color: #FFFF77">
                      Links: <a style="color: #81BEF7" href="toc.html">Table of Contents</a> |
                 <a style="color: #81BEF7" href="qa.html">QA Report</a>
          </span>
        </p>
      </div>  <!-- /inner-wrapper -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
    <div class="container">  <!-- container -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-post-footer -->
  
  <!-- JS and analytics only. -->
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script type="text/javascript" src="assets/js/bootstrap.min.js"> </script>
  <script type="text/javascript" src="assets/js/respond.min.js"> </script>
  <script type="text/javascript" src="assets/js/anchor.min.js"> </script>
  <script>anchors.options.visible = 'hover'
anchors.add()</script>
  
  <!-- Analytics Below
  ================================================== -->
  </body>
</html>