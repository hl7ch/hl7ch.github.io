<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
    <title>API - CH ELM (R4) v1.9.0</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link href="fhir.css" rel="stylesheet"/>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>

    <!-- Project extras -->
    <link href="assets/css/project.css" rel="stylesheet"/>
    <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
    <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
  	<link href="assets/css/prism.css" rel="stylesheet" />
  	<link href="assets/css/cqf.css" rel="stylesheet" />
    <!-- Placeholder for child template CSS declarations -->
    <link href="assets/css/hl7.css" rel="stylesheet"/>
    <link href="assets/css/fhir.css" rel="stylesheet"/>

    <style>
    

    

    

    </style>
 

    <script type="text/javascript" src="fhir-table-scripts.js"> </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->

    <!-- Favicons -->
    <link rel="fhir-logo" sizes="144x144" href="assets/ico/icon-fhir-144.png"/>
    <link rel="fhir-logo" sizes="114x114" href="assets/ico/icon-fhir-114.png"/>
    <link rel="fhir-logo" sizes="72x72" href="assets/ico/icon-fhir-72.png"/>
    <link rel="fhir-logo" href="assets/ico/icon-fhir-57.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body onload="document.body.style.opacity='1'">

	  <script src="assets/js/prism.js"></script>
    <script type="text/javascript" src="assets/js/mermaid.js"></script>
    <script type="text/javascript" src="assets/js/mermaid-init.js"></script>
    <style type="text/css">h2{--heading-prefix:"8"}
    h3,h4,h5,h6{--heading-prefix:"8"}</style>
    <div id="segment-header" class="segment">  <!-- segment-header -->
      <div class="container">  <!-- container -->

        <!-- Placeholder for child template header declarations -->

            <!--
<div id="family-nav">
	<a id="logo" no-external="true" href="http://hl7.org/fhir"> <img
		alt="logo fhir" src="assets/images/fhir-logo-www.png" />
	</a>
</div>
-->


            <div id="family-nav">
                <a id="logo" no-external="true" href="searchform.html">
                    <img src="assets/images/search.png" alt="Search FHIR" />
                </a>
            </div>
            <div id="hl7-nav">
    <a id="logo" no-external="true" href="https://www.bag.admin.ch/bag/en/home.html">
        <img alt="visit the website" height="60" src="bag-logo.jpg" />
    </a>            
</div>

        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">CH ELM (R4)</span>
            <br/>
            <span style="display:inline-block;">1.9.0 - release



  <img alt="Switzerland flag" src="assets/images/che.svg" height="16" title="Switzerland"/>


            </span>
          </p>
        </div>
      </div> <!-- /container -->
    </div>  <!-- /segment-header -->

    <div id="segment-navbar" class="segment">  <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">  <!-- container -->
        <!-- HEADER CONTENT -->

        <nav class="navbar navbar-inverse">
          <!--status-bar-->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <!-- menu.xml  -->

<ul xmlns="http://www.w3.org/1999/xhtml" class="nav navbar-nav">
  <li>
    <a href="toc.html">Table of Contents</a>
  </li>
  <li>
    <a href="index.html">Home</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Laboratory Report
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="document.html">FHIR Document</a>
      </li>
      <li>
        <a href="logical.html">Logical Model</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="usecase.html">Use Case</a>
  </li>
  <li>
    <a href="guidance.html">Guidance</a>
  </li>
  <li>
    <a href="profiles.html">Profiles</a>
  </li>
  <li>
    <a href="extensions.html">Extensions</a>
  </li>
  <li>
    <a href="api.html">API</a>
  </li>
  <li>
    <a href="terminology.html">Terminology</a>
  </li>
  <li>
    <a href="changelog.html">Changelog</a>
  </li>
  <li>
    <a href="businessrules.html">Business Rules</a>
  </li>
  <li>
    <a href="artifacts.html">Artifacts</a>
  </li>
</ul>
            </div>  <!-- /.nav-collapse -->
          </div>  <!-- /.container -->
        </nav>  <!-- /.navbar -->
      <!-- /HEADER CONTENT -->
      </div>  <!-- /container -->
    </div>  <!-- /segment-navbar -->
    <!--status-bar-->

    <div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
      <div class="container">  <!-- container -->
        <ul class="breadcrumb">
          <li><a href='toc.html'><b>Table of Contents</b></a></li><li><b>API</b></li>

        </ul>
      </div>  <!-- /container -->
    </div>  <!-- /segment-breadcrumb -->

    <a name="top"> </a>
    <div id="segment-content" class="segment">  <!-- segment-content -->
      <div class="container">  <!-- container -->
        <div class="row">
          <div class="inner-wrapper">

<style type="text/css">
h2:before{color:silver;counter-increment:section;content:var(--heading-prefix) " ";}
h3:before{color:silver;counter-increment:sub-section;content:var(--heading-prefix) "." counter(sub-section) " ";}
h4:before{color:silver;counter-increment:composite;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) " ";}
h5:before{color:silver;counter-increment:detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) " ";}
h6:before{color:silver;counter-increment:more-detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) "." counter(more-detail)" ";}
</style>
<div class="col-12">
  <!--ReleaseHeader--><p id="publish-box">This page is part of the Observations of notifiable communicable infectious diseases (v1.9.0: Release) based on <a data-no-external="true" href="http://hl7.org/fhir/R4">FHIR (HL7® FHIR® Standard) R4</a>. The current version which supersedes this version is <a data-no-external="true" href="http://fhir.ch/ig/ch-elm">1.13.1</a>.  For a full list of available versions, see the <a data-no-external="true" href="http://fhir.ch/ig/ch-elm/history.html">Directory of published versions</a></p><!--EndReleaseHeader-->
  <h2>API</h2>
  












    <p><!-- white space is critical inside of capture --></p>
<div class="markdown-toc">
<ul id="markdown-toc">
  <li><a href="#scope" id="markdown-toc-scope">Scope</a></li>
  <li><a href="#actor-roles" id="markdown-toc-actor-roles">Actor Roles</a></li>
  <li><a href="#referenced-standards" id="markdown-toc-referenced-standards">Referenced Standards</a></li>
  <li><a href="#send-report-transaction" id="markdown-toc-send-report-transaction">Send Report transaction</a></li>
  <li><a href="#verifying-processing-state" id="markdown-toc-verifying-processing-state">Verifying processing state</a></li>
  <li><a href="#security-considerations" id="markdown-toc-security-considerations">Security Considerations</a></li>
  <li><a href="#endpoints" id="markdown-toc-endpoints">Endpoints</a></li>
</ul>

</div>
<p>CH ELM defines a RESTful web API based on FHIR to enable a laboratory to send and verify the processing of its reports.</p>

<h3 id="scope">Scope</h3>
<p>The Send Report transaction provides a report from the laboratory to the FOPH.</p>

<p>After providing the report the laboratory shall verify through the API that the report has been successfully processed.</p>

<h3 id="actor-roles">Actor Roles</h3>
<p><strong>Actor:</strong> Laboratory <br />
<strong>Role:</strong> Sends a report in the CH ELM document format and metadata to the FOPH and verifies that the report has been successfully processed.</p>

<p><strong>Actor:</strong> FOPH <br />
<strong>Role:</strong> Accepts the report from the Document Source and processes the report in a later stage.</p>

<div><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="392px" preserveAspectRatio="none" style="width:772px;height:392px;background:#FFFFFF;" version="1.1" viewBox="0 0 772 392" width="772px" zoomAndPan="magnify"><defs /><g><rect fill="#FFFFFF" height="321.1953" style="stroke:#181818;stroke-width:1.0;" width="10" x="43" y="46.2969" /><rect fill="#FFFFFF" height="321.1953" style="stroke:#181818;stroke-width:1.0;" width="10" x="518" y="46.2969" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="48" x2="48" y1="36.2969" y2="385.4922" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="523" x2="523" y1="36.2969" y2="385.4922" /><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="12" y="24.9951">Laboratory</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="52" x="497" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="504" y="24.9951">FOPH</text><rect fill="#FFFFFF" height="321.1953" style="stroke:#181818;stroke-width:1.0;" width="10" x="43" y="46.2969" /><rect fill="#FFFFFF" height="321.1953" style="stroke:#181818;stroke-width:1.0;" width="10" x="518" y="46.2969" /><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="765" x="0" y="66.8633" /><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="765" y1="66.8633" y2="66.8633" /><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="765" y1="69.8633" y2="69.8633" /><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="111" x="327" y="56.2969" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="92" x="333" y="72.3638">Send Report</text><polygon fill="#181818" points="506,106.5625,516,110.5625,506,114.5625,510,110.5625" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="512" y1="110.5625" y2="110.5625" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="60" y="105.4966">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="428" x="73" y="105.4966">Request to provide DocumentReference with embedded Document</text><line style="stroke:#181818;stroke-width:1.0;" x1="528" x2="570" y1="139.6953" y2="139.6953" /><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="570" y1="139.6953" y2="152.6953" /><line style="stroke:#181818;stroke-width:1.0;" x1="529" x2="570" y1="152.6953" y2="152.6953" /><polygon fill="#181818" points="539,148.6953,529,152.6953,539,156.6953,535,152.6953" style="stroke:#181818;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="535" y="134.6294">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="548" y="134.6294">Extract the document</text><line style="stroke:#181818;stroke-width:1.0;" x1="528" x2="570" y1="181.8281" y2="181.8281" /><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="570" y1="181.8281" y2="194.8281" /><line style="stroke:#181818;stroke-width:1.0;" x1="529" x2="570" y1="194.8281" y2="194.8281" /><polygon fill="#181818" points="539,190.8281,529,194.8281,539,198.8281,535,194.8281" style="stroke:#181818;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="535" y="176.7622">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="548" y="176.7622">Validate document</text><line style="stroke:#181818;stroke-width:1.0;" x1="528" x2="570" y1="223.9609" y2="223.9609" /><line style="stroke:#181818;stroke-width:1.0;" x1="570" x2="570" y1="223.9609" y2="236.9609" /><line style="stroke:#181818;stroke-width:1.0;" x1="529" x2="570" y1="236.9609" y2="236.9609" /><polygon fill="#181818" points="539,232.9609,529,236.9609,539,240.9609,535,236.9609" style="stroke:#181818;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="535" y="218.895">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205" x="548" y="218.895">Queue document for processing</text><polygon fill="#181818" points="64,262.0938,54,266.0938,64,270.0938,60,266.0938" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58" x2="517" y1="266.0938" y2="266.0938" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="70" y="261.0278">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304" x="83" y="261.0278">Document accepted and queued for processing</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="765" x="0" y="294.6602" /><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="765" y1="294.6602" y2="294.6602" /><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="765" y1="297.6602" y2="297.6602" /><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="199" x="283" y="284.0938" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="180" x="289" y="300.1606">Verify Report processed</text><polygon fill="#181818" points="506,334.3594,516,338.3594,506,342.3594,510,338.3594" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="512" y1="338.3594" y2="338.3594" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="60" y="333.2935">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="277" x="73" y="333.2935">Check if document(s) have been processed</text><polygon fill="#181818" points="59,363.4922,49,367.4922,59,371.4922,55,367.4922" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="53" x2="522" y1="367.4922" y2="367.4922" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="65" y="362.4263">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396" x="78" y="362.4263">DocumentReference(s) either completed, failed or in-progress</text></g></svg></div>

<p><br clear="all" /></p>

<p><strong>Figure: Report Interactions</strong></p>

<h3 id="referenced-standards">Referenced Standards</h3>
<p>Release 4 of the <a href="https://hl7.org/fhir/r4/index.html">HL7® FHIR®</a> standard.</p>

<h3 id="send-report-transaction">Send Report transaction</h3>

<p>The Send report transaction passes a DocumentReference message from the laboratory to the FOPH, providing the report directly as a FHIR Bundle.</p>

<h4 id="send-report-message">Send Report Message</h4>
<p>This message uses the HTTP POST method on the DocumentReference endpoint to convey the metadata and the document as a FHIR DocumentReference.
See also the <a href="CapabilityStatement-ch-elm-documentrecipient.html">CapabilityStatement</a> of the server.</p>

<h5 id="trigger-events">Trigger Events</h5>

<p>This method is invoked when the laboratory needs to submit one document to the FOPH.</p>

<h5 id="message-semantics">Message Semantics</h5>

<p>The laboratory shall initiate a FHIR “create” action by sending an HTTP POST request method composed of a FHIR <a href="StructureDefinition-PublishDocumentReference.html">Publish DocumentReference</a>, with the document referenced in the <code class="language-plaintext highlighter-rouge">DocumentReference.content.attachment.url</code> element and provided as contained bundle.</p>

<p>The media type of the HTTP body shall be either <code class="language-plaintext highlighter-rouge">application/fhir+json</code> or <code class="language-plaintext highlighter-rouge">application/fhir+xml</code>.</p>

<p>The message is sent to the DocumentReference at the base URL as defined in FHIR. See <a href="http://hl7.org/fhir/R4/http.html">http://hl7.org/fhir/R4/http.html</a> for the definition of “HTTP” access methods and “base”.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">http://[base]/DocumentReference</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/fhir+json</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/fhir+json</span>

{
  "resourceType" : "DocumentReference",
  "contained" : [
    {
      "resourceType" : "Bundle",
      "id" : "1Doc-NeisseriaGonorrhoeae",
      "meta" : {
        "profile" : [
          "http://fhir.ch/ig/ch-elm/StructureDefinition/ch-elm-document",
          "http://hl7.eu/fhir/laboratory/StructureDefinition/Bundle-eu-lab"
        ]
      },
      "identifier" : {
        "system" : "urn:ietf:rfc:3986",
        "value" : "urn:uuid:1901332d-6012-443f-9690-9291adb2e19d"
      },
      "type" : "document"       
      // snip the rest of the bundle
    }
  ],
  "identifier" : [
    {
      "system" : "urn:ietf:rfc:3986",
      "value" : "urn:uuid:1901332d-6012-443f-9690-9291adb2e19d"
    }
  ],
  "status" : "current",
  "content" : [
    {
      "attachment" : {
        "language" : "de-CH",
        "url" : "#1Doc-NeisseriaGonorrhoeae"
      }
    }
  ]
}
</code></pre></div></div>

<h6 id="documentreference-resources">DocumentReference Resources</h6>

<p>DocumentReference needs to follow the <a href="StructureDefinition-PublishDocumentReference.html">Publish DocumentReference Profile</a> Resource metadata requirements. See <a href="DocumentReference-Publish-1Doc-NeisseriaGonorrhoeae.json.html">example</a>.</p>

<p>When resources are <code class="language-plaintext highlighter-rouge">contained</code> they shall be contained using the FHIR contained method (see <a href="http://hl7.org/fhir/R4/references.html#contained">http://hl7.org/fhir/R4/references.html#contained</a> ).</p>

<h5 id="expected-actions">Expected Actions</h5>

<p>The FOPH shall accept both media types <code class="language-plaintext highlighter-rouge">application/fhir+json</code> and <code class="language-plaintext highlighter-rouge">application/fhir+xml</code>.</p>

<p>On receipt of the  Publish Request Message, the FOPH shall extract the document from the DocumentReference.content.attachment.url and respond with one of the HTTP codes defined in the response <a href="http://hl7.org/fhir/R4/http.html#ops">http://hl7.org/fhir/R4/http.html#ops</a>.</p>

<p>If the FOPH encounters any errors or if any validation fails, the FOPH shall return an error using a FHIR OperationOutcome.</p>

<h4 id="send-report-response-message">Send Report Response Message</h4>

<p>After sending the report (FHIR document) to the FOPH, an HTTP Status code is returned appropriate to the processing outcome, conforming to the create transaction specification requirements as specified in <a href="http://hl7.org/fhir/R4/http.html#create">http://hl7.org/fhir/R4/http.html#create</a>.</p>

<p>If the FHIR document has passed the validation-process the returned response message body contains a DocumentReference-Resource with the FOPH-generated DocumentReference-ID and the status code <a href="https://fhir.ch/ig/ch-elm/DocumentReference-1-DocumentReferenceResponseInProgress.json.html">in-progress</a>. The DocumentReference-ID can be used to track the status of the document during the FOPH processing-steps. In case of a processing-issue, the status-code changes to <a href="https://fhir.ch/ig/ch-elm/DocumentReference-1-DocumentReferenceResponseFailed.json.html">failed</a>, if the document-processing is successful, the status-code changes to <a href="https://fhir.ch/ig/ch-elm/DocumentReference-1-DocumentReferenceResponseCompleted.json.html">completed</a> (see also chapter <a href="#message-semantics-3">Response message - Message semantics</a>).</p>

<p>“If the FHIR document is not valid, the returned response message body contains an OperationOutcome-Resource with information about the validation-errors. (The OperationOutcome contains neither a DocumentReference-ID nor a status-code).</p>

<h5 id="trigger-events-1">Trigger Events</h5>

<p>This message shall be sent when a success or error condition needs to be communicated. Success is only indicated once the document is received and validated to the FOPH Actor configuration.</p>

<h5 id="message-semantics-1">Message Semantics</h5>

<p>To enable the laboratory to know the outcome of processing the transaction, and the identities assigned to the resources by the FOPH, the FOPH shall return the DocumentReference as created conforming to <a href="StructureDefinition-PublishDocumentReferenceResponse.html">Publish DocumentReference Response</a>.</p>

<h5 id="expected-actions-1">Expected Actions</h5>

<p>The FOPH processes the results according to application-defined rules.</p>

<p><em>Important</em>: The laboratory shall afterwards check the status of the processing, see next message.</p>

<h3 id="verifying-processing-state">Verifying processing state</h3>

<p>The laboratory shall verify through the API that the reports have been successfully processed. The laboratory can either query the DocumentReference by id or query it with different search parameters.</p>

<h4 id="request-message">Request Message</h4>

<p>This message uses the search method parameterized query to obtain DocumentReference Resources from the FOPH.</p>

<h5 id="trigger-events-2">Trigger Events</h5>

<p>When the laboratory needs to discover DocumentReference Resources matching various metadata parameters, it issues a request message.</p>

<h5 id="message-semantics-2">Message Semantics</h5>

<p>The laboratory executes an HTTP search against the FOPHs DocumentReference URL. The search tar follows the FHIR HTTP specification, addressing the DocumentReference Resource <a href="http://hl7.org/fhir/R4/http.html">http://hl7.org/fhir/R4/http.html</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[base]/DocumentReference?&lt;query&gt;
</code></pre></div></div>

<p>If the id of the DocumentReference resource is known, it can be directly accessed by id instead of a query.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[base]/DocumentReference/id
</code></pre></div></div>

<p>This URL <code class="language-plaintext highlighter-rouge">[base]</code> is configurable by the FOPH and is subject to the following constraints:</p>

<p>The <code class="language-plaintext highlighter-rouge">&lt;query&gt;</code> represents a series of encoded name-value pairs representing the filter for the query as well as control parameters to modify the behavior of the FOPH such as response format, or pagination.</p>

<p>The laboratory can use GET searches.</p>

<h6 id="query-search-parameters">Query Search Parameters</h6>

<p>The laboratory may supply, and the FOPH shall be capable of processing, all query parameters listed below. All query parameter values shall be appropriately encoded per RFC3986 “percent” encoding rules. Note that percent encoding does restrict the character set to a subset of ASCII characters which is used for encoding all other characters used in the URL.</p>

<p>The parameters described below are optional. The FOPH must implement the parameters described below. The FOPH may choose to support additional query parameters beyond the subset listed below. Any additional query parameters supported shall be supported according to the core FHIR specification. Such additional parameters are considered out of scope for this transaction. Any additional parameters not supported should be ignored. See <a href="http://hl7.org/fhir/R4/search.html#errors">http://hl7.org/fhir/R4/search.html#errors</a>.</p>

<p><strong>date</strong>:
This parameter, of type date, specifies the time when the DocumentReference was created. See <a href="http://hl7.org/fhir/R4/search.html#date">http://hl7.org/fhir/R4/search.html#date</a> for use of the date search type.</p>

<p><strong>_lastUpdate</strong>:
The search parameter _lastUpdated can be used to select resources based on the last time they were changed. See <a href="http://hl7.org/fhir/R4/search.html#lastUpdated]">http://hl7.org/fhir/R4/search.html#lastUpdated</a> for use of the _lastUpdate search type.</p>

<p>for date and _lastUpdate the following <a href="http://hl7.org/fhir/R4/search.html#prefix">prefixes</a> for parameter are supported: eq,ne,gt,ge,lt, le</p>

<p><strong>identifier</strong>:
This parameter, of type token, specifies an identifier for this DocumentReference and/or the contained document. The search results represent the results of a search on DocumentReference.identifier.</p>

<p><strong>elm-status</strong>:
This <a href="SearchParameter-SearchParameter-ch-elm-status.html">parameter</a>, of type token, specifies the status of the processing of the report at the FOPH. It can be either in-progress, failed or completed, see <a href="ValueSet-ch-elm-status.html">ValueSet</a>. Only one status per query is supported, you cannot query for multiple (e.g. failed, complete).</p>

<h6 id="managing-returned-resources">Managing Returned Resources</h6>

<p><strong>Sorting</strong></p>

<p>The client can indicate which order to return the results by using the parameter <a href="http://hl7.org/fhir/R4/search.html#_sort">_sort</a>, which can contain a comma-separated list of sort rules in priority order.
The following support parameters can be specified: <strong>identifier</strong>, <strong>date</strong>, <strong>elm-status</strong>, <strong>_lastUpdated</strong>. A prefix of '-' indicates decreasing order; in its absence, 
the parameter is applied in increasing order.</p>

<p><strong>Paging</strong></p>

<p>The parameter <em>_count</em> is defined as an instruction to the server regarding how many resources should be returned in a single <a href="http://hl7.org/fhir/R4/search.html#count">page</a>.</p>

<p>If _count has the value 0, this shall be treated the same as _summary=count: the server returns a bundle that reports the total number of resources that match in Bundle.total, but with no entries, and no prev/next/last links.</p>

<p>FOPH allows with the parameter page to directly query a specific page in the search result. The client can also follow the first, next, prev, last link in the Bundle search response.</p>

<h6 id="populating-expected-response-format">Populating Expected Response Format</h6>

<p>The FHIR standard provides encodings for responses as either XML or JSON.</p>

<h6 id="example-documentreference-search-for-error-messages-since-a-specific-date">Example DocumentReference Search for error messages since a specific date</h6>

<h6 id="example">Example</h6>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET http://[base]/DocumentReference?_lastUpdate=gt2023-10-02T08:00:00+02:00&amp;elm-status=failed
</code></pre></div></div>

<h5 id="actions">Actions</h5>

<p>The FOPH shall process the query to discover the DocumentReference entries that match the search parameters given.</p>

<h4 id="response-message">Response Message</h4>

<p>The FOPH returns a HTTP Status code appropriate to the processing as well as a Bundle of the matching DocumentReference Resources for the query, DocumentReference resource if the DocumentReference was accessed by id.</p>

<h5 id="trigger-events-3">Trigger Events</h5>

<p>The FOPH completed processing of the request message.</p>

<h5 id="message-semantics-3">Message Semantics</h5>

<p>Based on the query results, the FOPH will either return an error or success. Guidance on handling Access Denied related to use of 200, 403 and 404 can be found in <a href="https://profiles.ihe.net/ITI/TF/Volume2/ch-Z.html#z.8-mobile-security-considerations">ITI TF-2x: Appendix Z.7</a>.</p>

<p>When the FOPH needs to report an error, it shall use HTTP error response codes and should include a FHIR OperationOutcome with more details on the failure. See FHIR <a href="http://hl7.org/fhir/R4/http.html">http://hl7.org/fhir/R4/http.html</a> and <a href="http://hl7.org/fhir/R4/operationoutcome.html">http://hl7.org/fhir/R4/operationoutcome.html</a>.</p>

<p>If the query is processed successfully, whether or not any DocumentReference Resources are found, the HTTP status code shall be 200. The response message shall be a Bundle Resource containing zero or more DocumentReference Resources.</p>

<p>The response shall adhere to the FHIR Bundle constraints <a href="StructureDefinition-FindDocumentReferencesResponse.html">specified</a>.</p>

<p><a href="Bundle-ex-findDocumentReferencesResponse.json.html">Example search response</a>.</p>

<h6 id="documentreference-resource-contents">DocumentReference Resource Contents</h6>

<p>The response message body contains a DocumentReference-Resource with a reference to the contained OperationOutcome-Resource (validation messages) and a status-code indicating the status of the document processing: in-progress, failed, completed. The status “failed” indicates that the document could not be processed due to further conformity issues. Please note, that failed FHIR-documents are NOT inserted in our database and have to be corrected and re-submitted.</p>

<p>Example of such responses:
<a href="DocumentReference-1-DocumentReferenceResponseInProgress.json.html">in-progress</a>, <a href="DocumentReference-1-DocumentReferenceResponseFailed.json.html">failed</a>, <a href="DocumentReference-1-DocumentReferenceResponseCompleted.json.html">completed</a>.</p>

<h4 id="expected-actions-2">Expected Actions</h4>

<p>The laboratory shall process the results. It is in the responsibility of the laboratory to resubmit the failed responses.</p>

<h3 id="security-considerations">Security Considerations</h3>

<p>mTLS shall be used.</p>
<div class="dragon">
During the pilot a TLS client certificate will be provided by the FOPH.
</div>
<p>&nbsp;</p>

<h3 id="endpoints">Endpoints</h3>

<p>The following endpoints are defined:</p>

<p><strong>Integration System</strong>: 
https://ws.infreport-a.bag.admin.ch/ch-elm/v1/fhir</p>

<p><strong>Production System</strong>: 
https://ws.infreport.bag.admin.ch/ch-elm/v1/fhir</p>




</div>
        </div>  <!-- /inner-wrapper -->
      </div>  <!-- /row -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-content -->

  <script type="text/javascript" src="assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script type="text/javascript" src="assets/js/jquery-ui.min.js"> </script>

  <script type="text/javascript" src="assets/js/window-hash.js"> </script>
  <a name="bottom"> </a>
  <div id="segment-footer" igtool="footer" class="segment">  <!-- segment-footer -->
    <div class="container">  <!-- container -->

      <div class="inner-wrapper">
        <p>
          IG &#169; 2023+ <a style="color:var(--footer-hyperlink-text-color)" href="https://www.bag.admin.ch/bag/en/home/das-bag/kontakt-standort.html">Federal Office of Public Health FOPH</a>.  Package ch.fhir.ig.ch-elm#1.9.0 based on <a style="color: var(--footer-hyperlink-text-color)" href="http://hl7.org/fhir/R4/">FHIR 4.0.1</a>. Generated <span title="Tue, Mar 18, 2025 17:05+0000">2025-03-18</span>
          <br/>
          <span style="color: var(--footer-highlight-text-color)">
                      Links: <a style="color: var(--footer-hyperlink-text-color)" href="toc.html">Table of Contents</a> |
                 <a style="color: var(--footer-hyperlink-text-color)" href="qa.html">QA Report</a>
                 
                

| <a style="color: #81BEF7" target="_blank" href="https://docs.google.com/forms/d/e/1FAIpQLSefM7pEMiqyr1AOEVFfoo54nKBLmuSffdyh3EonFfxhFLrcwA/viewform?usp=sf_link&amp;entry%2E1353807103=ch.fhir.ig.ch-elm%231.9.0%20/api.html&amp;entry%2E247644557=API">Propose a change</a>




          </span>
        </p>
      </div>  <!-- /inner-wrapper -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
    <div class="container">  <!-- container -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-post-footer -->

  <!-- JS and analytics only. -->
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="assets/js/bootstrap.min.js"> </script>
  <script type="text/javascript" src="assets/js/respond.min.js"> </script>
  <script type="text/javascript" src="assets/js/anchor.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard-btn.js"> </script>
  <script type="text/javascript" src="assets/js/anchor-hover.js"> </script>
  <!-- Analytics Below
  ================================================== -->
  </body>
</html>

